
<SPAN CLASS="Text1">

<P>
<B>Procedure Windows</B><BR>
<B>Beta Draft</B><BR>
<B>Author:</B> (Author's Name)<BR>
<B>Date Last Updated:</B> (Date)<BR>
<B>Scheduled Release:</B> (Release Number)
</P>

<HR SIZE="1" NOSHADE>

<P>
<B>Revision History</B>
The following revisions have been made to this document:<BR>
<BR>
Date: (date)	<BR>
Revision: (rev-no)	<BR>
Developer: (developer)	<BR>
Summary of Changes: (summary)
</P>

<HR SIZE="1" NOSHADE>

<P>
Copyright &copy; 2000 by Progress Software Corporation ("PSC"), 14 Oak Park, Bedford, MA 01730, 
and other contributors as listed below. All Rights Reserved.
</P>

<P>
The Initial Developer of the Original Code is PSC. The Original Code is Progress IDE code 
released to open source December 1, 2000.
</P>

<P>
The contents of this file are subject to the Possenet Public License Version 1.0 (the "License"); 
you may not use this file except in compliance with the License. A copy of the License is available 
as of the date of this notice at <A HREF="http://www.possenet.org/license.html">http://www.possenet.org/license.html</A>
</P>

<P>
Software distributed under the License is distributed on an "AS IS" basis, WITHOUT WARRANTY OF 
ANY KIND, either express or implied. You should refer to the License for the specific language 
governing rights and limitations under the License. 
</P>

<HR SIZE="1" NOSHADE>

<P>
<B>Contributors</B>
<BR>
Jane Contributor, Joe Contributor
</P>

<HR SIZE="1" NOSHADE>

<P>
<B>Contents</B>
</P>

<P>
1. <A HREF="#1">Overview</A><BR>
2. <A HREF="#2">Architecture</A><BR>
2.1 <A HREF="#2.1">Program Architecture</A><BR>
2.2 <A HREF="#2.2">Starting Procedure Windows</A><BR>
2.3 <A HREF="#2.3">Startup Processing</A><BR>
2.4 <A HREF="#2.4">Closing Procedure Windows</A><BR>
2.5 <A HREF="#2.5">Dynamically Created User Interface</A><BR>
2.5.1 <A HREF="#2.5.1">Procedure Window</A><BR>
2.5.2 <A HREF="#2.5.2">Editor Frame</A><BR>
2.5.3 <A HREF="#2.5.3">Editor Buffer</A><BR>
2.5.4 <A HREF="#2.5.4">Menubar and Popup Menu</A><BR>
2.5.5 <A HREF="#2.5.5">Procedure Window Widget Pool</A><BR>
2.6 <A HREF="#2.6">Event Processing</A><BR>
2.7 <A HREF="#2.7">Persistent Attribute Data</A><BR>
2.7.1 <A HREF="#2.7.1">Attribute Data Preprocessor Strings</A><BR>
2.7.2 <A HREF="#2.7.2">How Attribute Data Values are Stored</A><BR>
2.7.3 <A HREF="#2.7.3">Accessing Attribute Data Values</A><BR>
3. <A HREF="#3">Primary Data Structures</A><BR>
4. <A HREF="#4">Primary Algorithms and Processes</A><BR>
4.1 <A HREF="#4.1">Menus</A><BR>
4.1.1 <A HREF="#4.1.1">File Menu </A><BR>
4.1.2 <A HREF="#4.1.2">Edit Menu</A><BR>
4.1.3 <A HREF="#4.1.3">Format Selection Submenu</A><BR>
4.1.4 <A HREF="#4.1.4">Search Menu</A><BR>
4.1.5 <A HREF="#4.1.5">Compile Menu</A><BR>
4.1.6 <A HREF="#4.1.6">Help Menu</A><BR>
5. <A HREF="#5">Advanced Topics</A><BR>
6. <A HREF="#6">Dependencies</A><BR>
7. <A HREF="#7">Source Files</A><BR>
8. <A HREF="#8">Build Process and Requirements</A><BR>
9. <A HREF="#9">Execution Methods</A><BR>
10. <A HREF="#10">Test Requirements and Strategies</A><BR>
11. <A HREF="#11">Supplementary Information</A><BR>
12. <A HREF="#12">Related Documentation</A>
</P>


<P>
<A NAME="1"><B>1. Overview</B></A>
</P>

<P>
Procedure Windows are used to create, edit, save, compile,
and run Progress procedure files. The files created and edited with a Procedure
Window are free-form source files. This means the files do not follow a
specific structure, unlike files created using the AppBuilder which do have a
specific source code structure. A Procedure Window’s functionality is accessed
using menu options, mouse operations, and keyboard commands. A user can easily
edit and view multiple source procedure files, as well as copy and paste
between them. While any number of Procedure Windows can be open simultaneously,
only a single procedure file can be edited in a Procedure Window.
</P>

<P>
<A NAME="2"><B>2. Architecture</B></A>
</P>

<P>
<A NAME="2.1"><B>2.1 Program Architecture</B></A>
</P>

<P>
A Procedure Window is not a persistently running procedure
and it does not have any wait-for or other input blocking statements. Procedure
Windows don't block for input with a wait-for or update to allow other ADE
Tools to be accessible while any number of Procedure Windows are open and
available to edit files. Instead, Procedure Windows and their interface widgets
are dynamically created with appropriately attached persistent triggers to
handle event processing and execute Procedure Window functionality.
</P>

<P>
<A NAME="2.2"><B>2.2 Starting Procedure Windows</B></A>
</P>

<P>
The adecomm/_pwmain.p procedure is the main program for
creating Procedure Windows. It can be called as often as required to open
Procedure Windows. You can open multiple Procedure Windows at one time by
passing this procedure a list of files to open. If you do not pass a list of
files to open, this procedure creates one untitled Procedure Window.
</P>

<P>
The following code example shows the call syntax for
running _pwmain.p to create Procedure Windows:
</P>



<P>
RUN adecomm/_pwmain.p (INPUT
p_Parent_ID /* PW Parent ID */ ,
</P>

<P>
 INPUT File_List /* Files to open */ ,
</P>

<P>
 INPUT p_Edit_Command /* PW Command */ ).
</P>



<P>
The following table
describes the parameters for _pwmain.p:
</P>


 
  
   
   
<P>
   Parameter
</P>
   
   
<P>
   Data Type
</P>
   
   
   
<P>
   Description
</P>
   
  
 
 
  
<P>
  INPUT p_Parent_ID
</P>
  
  
<P>
  Character
</P>
  
  
<P>
  String value
  indicating &quot;Parent&quot; of Procedure Window. Pass Null (&quot;&quot;)
  if no parent. The p_Parent_ID parameter should be the name of the calling
  tool. When the tool exits, it calls adecomm/_pwexit.p and passes p_Parent_ID
  again. This procedure uses p_Parent_ID to close only those Procedure Windows
  created by the calling parent.
  It’s best to pass
  the application or tool startup procedure name. For example, the Procedure
  Editor passes a parent value of “_edit.p”. This allows adecomm/_pwexit.p to
  determine if the caller is the client session startup routine (-p). If it is,
  then all Procedure Windows are closed (not just those owned by the caller).
  This takes care of those Procedure Windows created by the PRO*Tools Editor
  applet. Otherwise, their contents would be lost when the session ends. When
  the caller is not the session startup procedure, then only those Procedure
  Windows created by the exiting parent are closed.
  Procedure Windows
  that are opened from other Procedure Windows inherit the Parent ID from the
  Procedure Window that opened them.
</P>
  
 
 
  
<P>
  INPUT p_FileList
</P>
  
  
<P>
  Character
</P>
  
  
<P>
  Comma-delimited
  list of files to open in Procedure Windows. A null value (“”) opens a
  Procedure Window with an Untitled procedure.
  Each file is
  opened in its own Procedure Window.
  If a file cannot
  be found, a warning message is displayed in an alert box.
  If the file to
  open exists on a remote WebSpeed agent, the OS file name will contain three
  CHR(3)-delimited parts; file name, local temp file name, and Broker URL to
  use to save the file.
</P>
  
 
 
  
<P>
  INPUT
  p_Edit_Command
</P>
  
  
<P>
  Character
</P>
  
  
<P>
  Either Null
  (&quot;&quot;) for no special processing other than to open a Procedure
  Window or &quot;UNTITLED&quot; to force a template file to be opened
  Untitled.
</P>
  
 


<P>
<A NAME="2.3"><B>2.3 Startup Processing</B></A>
</P>

<P>
The _pwmain.p procedure calls a series of other _pw*.p
procedures to construct a Procedure Window during its startup processing. The
following process describes the steps _pwmain.p performs to create a Procedure
Window:
</P>

<P>
1.
Initializes the Procedure Window persistent widget pool named
“&quot;_ADE_Procedure_Window”.
</P>

<P>
2.
Dynamically creates the main menubar, which is later added to
the window widget. All appropriate persistent triggers are attached to the menu
items as needed. This is accomplished with the following call:
</P>



<P>
RUN adecomm/_pwmbar.p (
INPUT NO /* p_Popup */,
</P>

<P>
 OUTPUT h_menu /* PW Menubar Handle */ ).
</P>



<P>
3.
Dynamically creates the window, frame, and editor widgets to
represent the Procedure Window user interface. The window handle of the created
window widget is returned. This is accomplished with the following call:
</P>



<P>
RUN adecomm/_pwcreat.p (
INPUT p_Parent_ID /* Parent ID */ ,
</P>

<P>
 INPUT . (other input parameters),
</P>

<P>
 INPUT
h_menu /* Menubar */ ,
</P>

<P>
 OUTPUT h_win /* Window H */ ).
</P>



<P>
4.
Creates and attaches the editor widget's popup menu. This is
accomplished with a call to the same procedure used to create the main menubar,
except “YES” is passed for the input parameter to indicate _pwmbar.p should
create and return a popup menu handle instead of a menubar handle. Procedure
_pwmbar.p creates a popup menu very similar to the Procedure Editor popup menu
with minor variations tailored to the Procedure Window. All appropriate
persistent triggers are attached to the menu items when they are created.
</P>

<P>
5.
If processing a specified file name (not Untitled), try to
read that file. This is accomplished with the following call:
</P>



<P>
RUN adecomm/_pwrdfl.p
(INPUT h_ed,
</P>

<P>
 INPUT (Proc_Name +
.),
</P>

<P>
 OUTPUT Read_OK).
</P>



<P>
6.
If the file is read successfully, or an Untitled Procedure
Window is created, enter the window for editing. This is accomplished with an
apply entry to the dynamically created editor widget.
</P>

<P>
7.
If no Procedure Window is opened as a result of the previous
processing steps, open an Untitled Procedure Window using the parent id passed
to _pwmain.p. This is accomplished in the following call:
</P>



<P>
IF PW_Opened = FALSE THEN
</P>

<P>
RUN adecomm/_pwmain.p (INPUT
p_Parent_ID /* PW Parent ID */ ,
</P>

<P>
 INPUT &quot;&quot; /* Files to open */ ,
</P>

<P>
 INPUT &quot;&quot; /* PW Command
*/ ).
</P>



<P>
8.
Continue processing the files to open list until there are no
more files to process.
</P>

<P>
This startup process results in opening either a single
untitled Procedure Window or several Procedure Windows. In either case, each
Procedure Window contains a file for editing.
</P>

<P>
<A NAME="2.4"><B>2.4 Closing Procedure Windows</B></A>
</P>

<P>
A Procedure Window closes itself when the File&gt;Close Window
option is chosen. However, a tool or application object that created additional
Procedure Windows is responsible for closing any open Procedure Windows when it
exits or closes.
</P>

<P>
When an application object (such as an ADE tool) starts a
Procedure Window, it passes a Parent ID to the Procedure Window. The Parent ID
should uniquely identify the Procedure Window as belonging to that application
object. See section 2.2 &quot;Starting Procedure Windows&quot; for a
description of Parent ID.
</P>

<P>
When an application object is exiting or closing, it can
close all its currently open Procedure Windows using the following call to
adecomm/_pwexit.p:
</P>



<P>
RUN adecomm/_pwexit.p (INPUT
Object-Name /* PW Parent ID */,
</P>

<P>
 OUTPUT OK_Close /* All PW closed */).
</P>



<P>
The _pwexit.p procedure searches through all of the
windows in the current session for Procedure Windows belonging to the parent
specified by Object-Name (the p_Parent_Id parameter), and closes all Procedure
Windows for the specified parent. If all of the parent object's Procedure
Windows close successfully, output parameter p_OK_Close is returned as TRUE.
Otherwise, it's returned as FALSE or Unknown.
</P>

<P>
Note:
If the specified parent window that is closing is also the session startup
procedure, then the Progress session is ending and _pwexit.p closes all
Procedure Windows.
</P>

<P>
<A NAME="2.5"><B>2.5 Dynamically Created User Interface</B></A>
</P>

<P>
All user interface elements of a Procedure Window are
created dynamically. The adecomm/_pwcreat.p procedure creates all Procedure
Window interface widgets, except for the menubar and popup menu. The menus are
created by the adecomm/_pwmbar.p procedure.
</P>

<P>
<A NAME="2.5.1"><B>2.5.1 Procedure Window</B></A>
</P>

<P>
A Procedure Window is displayed in a dynamically created
window widget. A Procedure Window stores two important pieces of information in
the following window widget attributes: 
</P>

<P>
Private-data
attribute — Stores the Procedure Window's Parent ID, if there is one, or
the question mark string (&quot;?&quot;) if the Parent ID is unknown. 
</P>

<P>
Name attribute
— Stores the Procedure Window tool name, which is the string &quot;Procedure
Window&quot;, as specified by the PW_Name preprocessor defined in
adecomm/_pwglob.i.
</P>

<P>
<A NAME="2.5.2"><B>2.5.2 Editor Frame</B></A>
</P>

<P>
Except for the menubar and popup menu, all Procedure
Window widgets are contained in a dynamically created frame widget called the
editor frame. No Procedure Window information is stored in editor frame
attributes. However, in addition to the editor buffer where code is typed, the
editor frame holds hidden fields that store Procedure Window persistent
attribute data. See section 2.7 &quot;Persistent Attribute Data&quot; for details.
</P>

<P>
<A NAME="2.5.3"><B>2.5.3 Editor Buffer</B></A>
</P>

<P>
When you type code in a Procedure Window, you are typing
into an editor buffer that is a dynamically created editor widget. The editor
buffer's Private-Data attribute stores several persistent Procedure Window
attribute data values. See section 2.7 &quot;Persistent Attribute Data&quot; for details.
</P>

<P>
<A NAME="2.5.4"><B>2.5.4 Menubar and Popup Menu</B></A>
</P>

<P>
Procedure Window menubar and popup menus are created
dynamically. No Procedure Window information is stored in the attributes of
these menus.
</P>

<P>
The adecomm/_pwmbar.p procedure creates both the menubar
and popup menu for a Procedure Window. When input parameter p_Popup is true,
_pwmbar.p creates a popup menu. When p_Popup is false, _pwmbar.p creates a
menubar menu. The p_Hmenubar output parameter returns the handle to whichever
menu is created.
</P>

<P>
Several menubar and popup menu options are enabled or
disabled depending on such factors as whether or not text is selected and
whether or not the editor buffer is read-only. The enabling of menu items is
accomplished using a MENU-DROP trigger defined for the menubar and popup menu
that runs the adecomm/_pwemdrp.p procedure. The adecomm/_pwemdrp.p procedure
performs the enabling and disabling of menu items. The items to enable and
disable are specified in _pwemdrp.p. The procedure dynamically walks the
menubar or popup menu to set the sensitive state of the appropriate menu items.
Each item is identified by a menu item label (except the ampersand (&amp;) notation
for programming menu short cuts). Because items are identified by menu item
labels, the _pwemdrp.p procedure must have its labels match the menu labels
defined in adecomm/_pwmbar.p.
</P>

<P>
<A NAME="2.5.5"><B>2.5.5 Procedure Window Widget Pool</B></A>
</P>

<P>
The dynamically created Procedure Window interface widgets
are created in a persistent widget pool named
&quot;_ADE_Procedure_Window,&quot; defined in the _pwglob.i include file by the
preprocessor definition PW_Pool and created in the adecomm/_pwmain.p Procedure
Window program. The dynamic widgets are created in a widget pool to prevent
them from being created in some other tool's widget pool. That could lead to
the unwanted deletion of Procedure Windows when the other tool is closed and
its widget pool is deleted.
</P>

<P>
<A NAME="2.6"><B>2.6 Event Processing</B></A>
</P>

<P>
A Procedure Window attaches persistent triggers to its
dynamically created user interface during Procedure Window startup. These
persistent triggers handle Procedure Window event processing. The persistent
triggers call external Procedure Window files (adecomm/_pw*.p) to execute
Procedure Window functionality. Except for editing features such as typing,
paging, and mouse operations, most of this functionality is invoked using
menubar and popup menu options. The adecomm/_pwmbar.p procedure creates the
Procedure Window menubar and popup menu and attaches the triggers that invoke
Procedure Window functionality.
</P>

<P>
<A NAME="2.7"><B>2.7 Persistent Attribute Data</B></A>
</P>

<P>
Procedure Windows must keep certain pieces of data
persistent. For example, a Procedure Window's Find dialog box displays the same
Find Text, Match Case, Direction, and other information as the last time it was
invoked. Because Procedure Windows are not persistently running procedures and
do not block for input, they cannot store their persistent data items in
variables or temp-tables. Instead, Procedure Windows store their persistent
data items using what is called Procedure Window attribute data items.
</P>

<P>
Attribute data items have two important features to
understand: preprocessor defined strings that identify and describe the data
items, and the mechanism by which the data items are stored and accessed. The
following sections describe these features. 
</P>

<P>
Note:
For more help with understanding Procedure Window attribute data items and
values, read the comments and code in the following source files: adecomm/_pwattr.i,
adecomm/_pwcreat.p, and adecomm/_pwsrch.p.
</P>

<P>
<A NAME="2.7.1"><B>2.7.1 Attribute Data Preprocessor Strings</B></A>
</P>

<P>
Attribute data items have preprocessor defined strings
that identify and describe the persistent data Procedure Windows store and use.
Following is the format of the preprocessor defined strings:
</P>



<P>
PW_Attribute &quot;LABEL,DATA-TYPE,INITIAL-VALUE&quot;
</P>



<P>
LABEL —
Uniquely identifies an attribute data item. For example, the Find Text
attribute is identified with a label value of &quot;Find_Text&quot;. Some
attribute data items are stored in fill-in fields in a Procedure Window's
frame. For those data items, the LABEL value specifies the fill-in's label. It
is used to identify an attribute to save and retrieve data.
</P>

<P>
DATA-TYPE — For
data items stored in fill-in fields in the Procedure Window frame, the
DATA-TYPE value identifies the fill-in's data-type.
</P>

<P>
INITIAL-VALUE —
Specifies an attribute's initial value.
</P>

<P>
The following preprocessor defined strings for the
Procedure Window attribute data items are defined in the adecomm/_pwattr.i
include file:
</P>



<P>
&amp;GLOBAL-DEFINE PW_Find_Text &quot;Find_Text,CHARACTER,&quot;
</P>

<P>
&amp;GLOBAL-DEFINE PW_Replace_Text &quot;Replace_Text,CHARACTER,&quot;
</P>

<P>
&amp;GLOBAL-DEFINE PW_Find_Direction &quot;Find_Direction,CHARACTER,DOWN&quot;
</P>

<P>
&amp;GLOBAL-DEFINE PW_Find_Case &quot;Find_Case,LOGICAL,NO&quot;
</P>

<P>
&amp;GLOBAL-DEFINE PW_Find_Wrap &quot;Find_Wrap,LOGICAL,YES&quot;
</P>

<P>
&amp;GLOBAL-DEFINE PW_Replace_Case &quot;Replace_Case,LOGICAL,NO&quot;
</P>

<P>
&amp;GLOBAL-DEFINE PW_Replace_Wrap &quot;Replace_Wrap,LOGICAL,YES&quot;
</P>

<P>
&amp;GLOBAL-DEFINE PW_Schema_Prefix &quot;Schema_Prefix,INTEGER,1&quot;
</P>



<P>
Procedure Window code uses the information in these
preprocessor defined strings to store and access attribute data item values.
</P>

<P>
<A NAME="2.7.2"><B>2.7.2 How Attribute Data Values are Stored</B></A>
</P>

<P>
The data value of an
attribute data item is stored in one of two ways:
</P>

<P>
·
As an individual value in the Private-Data property of
a dynamically created fill-in widget that is hidden in the Procedure Window's
editor frame.
</P>

<P>
·
As an entry in a comma-delimited list of values in the
Private-Data property of the Procedure Window's editor buffer.
</P>

<P>
Two attribute data items have their values stored in the
Private-Data field of a fill-in field: the Find Text and Replace Text fields
used in the Find and Replace dialog boxes. These attributes are stored in their
own fill-in fields because their values can be multi-line text of any kind. It
would be problematic to determine an appropriate delimiter to use for accessing
them if they were stored along with the list of attribute values in the editor
buffer's Private-Data property. All other attribute data item values are stored
in a comma-delimited list in the Private-Data property of the Procedure
Window's editor buffer.
</P>

<P>
The attribute data items are first created and have their
initial values stored when the editor frame is created in adecomm/_pwcreat.p
during startup processing, as shown in the following code taken from
_pwcreat.p:
</P>



<P>
/* Use the Editor Frame to
hold these PW's Search Attributes. We placed these in FILL-IN widgets of their
own because they can be multi-line text strings. Because of the EOL characters,
this could be tricky to store properly in a delimited-list. */
</P>



<P>
RUN CreateFrameAttr ( INPUT
h_frame , {&amp;PW_Find_Text} ).
</P>

<P>
RUN CreateFrameAttr ( INPUT
h_frame , {&amp;PW_Replace_Text} ).
</P>



<P>
/* Additional PW Attributes
are stored in comma-list in ED:PRIVATE-DATA. */
</P>



<P>
RUN InitAttr ( INPUT h_ed ).
</P>



<P>
The CreateFrameAttr and InitAttr procedures are defined in
the adecomm/_pwattr.i include file.
</P>

<P>
If the Procedure Window is open to edit a remote WebSpeed
file, the WebSpeed attributes for the name of the local temporary web file and
the remote broker URL are also added to the editor buffer's Private-Data
property in code run directly in _pwcreat.p.
</P>

<P>
<A NAME="2.7.3"><B>2.7.3 AccessingAttribute Data Values</B></A>
</P>

<P>
The Find and Replace dialog attribute data item values are
accessed using the GetSrchAttr and PutSrchAttr procedures defined in
adecomm/_pwsrch.p. Attribute values stored in the editor buffer's Private-Data
property are accessed using ENTRY function calls.
</P>

<P>
To access attribute values stored in the Private-Data
property of the fill-in fields in the editor frame, _pwsrch.p first gets the
handle of the required fill-in widget using a call to the GetFrameAttr
procedure (defined in adecomm/_pwattr.i) and then accesses the data item value
directly using the Private-Data property. 
</P>

<P>
<A NAME="3"><B>3. Primary Data Structures</B></A>
</P>

<P>
Not
applicable.
</P>

<P>
<A NAME="4"><B>4. Primary Algorithms and Processes</B></A>
</P>

<P>
<A NAME="4.1"><B>4.1 Menus</B></A>
</P>

<P>
This section presents the
Procedure Window menus with their associated menu items and underlying
procedures.
</P>

<P>
<A NAME="4.1.1"><B>4.1.1 File Menu</B></A>
</P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
</P>
   
  
 
 
  
<P>
  New
</P>
  
  
<P>
  RUN
  adecomm/_pwfile.p (&quot;NEW&quot;).
</P>
  
 
 
  
<P>
  Open
</P>
  
  
<P>
  RUN
  adecomm/_pwfile.p (&quot;OPEN&quot;).
</P>
  
 
 
  
<P>
  New Procedure
  Window
</P>
  
  
<P>
  RUN
  adecomm/_pwfile.p (&quot;NEW-PWIN&quot;).
</P>
  
 
 
  
<P>
  Save
</P>
  
  
<P>
  RUN
  adecomm/_pwfile.p (&quot;SAVE&quot;).
</P>
  
 
 
  
<P>
  Save As
</P>
  
  
<P>
  RUN
  adecomm/_pwfile.p (&quot;SAVE-AS&quot;).
</P>
  
 
 
  
<P>
  Print
</P>
  
  
<P>
  RUN
  adecomm/_pwfile.p (&quot;PRINT&quot;).
</P>
  
 
 
  
<P>
  Close Window
</P>
  
  
<P>
  RUN
  adecomm/_pwfile.p (&quot;CLOSE&quot;).
</P>
  
 


<P>
<A NAME="4.1.2"><B>4.1.2 Edit Menu</B></A>
</P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
</P>
   
  
 
 
  
<P>
  Undo
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;UNDO&quot;).
</P>
  
 
 
  
<P>
  Cut
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;CUT&quot;).
</P>
  
 
 
  
<P>
  Copy
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;COPY&quot;).
</P>
  
 
 
  
<P>
  Paste
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;PASTE&quot;).
</P>
  
 
 
  
<P>
  Insert File
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;INSERT-FILE&quot;).
</P>
  
 
 
  
<P>
  Insert Fields
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;INSERT-FIELDS&quot;).
</P>
  
 
 
  
<P>
  Format Selection
</P>
  
  
<P>
  Submenu
</P>
  
 


<P>
<A NAME="4.1.3"><B>4.1.3 Format Selection Submenu</B></A>
</P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
</P>
   
  
 
 
  
<P>
  Indent
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;INDENT-SELECTION&quot;).
</P>
  
 
 
  
<P>
  Unindent
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;UNINDENT-SELECTION&quot;).
</P>
  
 
 
  
<P>
  Comment
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;COMMENT-SELECTION&quot;).
</P>
  
 
 
  
<P>
  Uncomment
</P>
  
  
<P>
  RUN
  adecomm/_pwedit.p (&quot;UNCOMMENT-SELECTION&quot;).
</P>
  
 


<P>
<A NAME="4.1.4"><B>4.1.4 Search Menu</B></A>
</P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
</P>
   
  
 
 
  
<P>
  Find
</P>
  
  
<P>
  RUN
  adecomm/_pwsrch.p (&quot;FIND&quot;).
</P>
  
 
 
  
<P>
  Find Next
</P>
  
  
<P>
  RUN
  adecomm/_pwsrch.p (&quot;FIND-NEXT&quot;).
</P>
  
 
 
  
<P>
  Find Previous
</P>
  
  
<P>
  RUN
  adecomm/_pwsrch.p (&quot;FIND-PREV&quot;).
</P>
  
 
 
  
<P>
  Replace
</P>
  
  
<P>
  RUN
  adecomm/_pwsrch.p (&quot;REPLACE&quot;).
</P>
  
 
 
  
<P>
  Goto Line
</P>
  
  
<P>
  RUN
  adecomm/_pwsrch.p (&quot;GOTO-LINE&quot;).
</P>
  
 


<P>
<A NAME="4.1.5"><B>4.1.5 Compile Menu</B></A>
</P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
</P>
   
  
 
 
  
<P>
  Run
</P>
  
  
<P>
  RUN
  adecomm/_pwcomp.p (&quot;RUN&quot;).
</P>
  
 
 
  
<P>
  Check Syntax
</P>
  
  
<P>
  RUN
  adecomm/_pwcomp.p (&quot;CHECK-SYNTAX&quot;).
</P>
  
 


<P>
<A NAME="4.1.6"><B>4.1.6 Help Menu</B></A>
</P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
</P>
   
  
 
 
  
<P>
  Press F1 in Edit Area
</P>
  
  
<P>
  RUN
  adecomm/_pwhelp.p ( INPUT &quot;KEYWORD&quot; ).
</P>
  
 
 
  
<P>
  Help Topics
</P>
  
  
<P>
  RUN
  adecomm/_pwhelp.p (&quot;TOPICS&quot;).
</P>
  
 
 
  
<P>
  Messages
</P>
  
  
<P>
  RUN
  adecomm/_pwhelp.p (&quot;MESSAGES&quot;).
</P>
  
 
 
  
<P>
  Recent Messages
</P>
  
  
<P>
  RUN
  adecomm/_pwhelp.p (&quot;RECENT-MESSAGES&quot;).
</P>
  
 


<P>
<A NAME="5"><B>5. Advanced Topics</B></A>
</P>

<P>
Not
applicable.
</P>

<P>
<A NAME="6"><B>6. Dependencies</B></A>
</P>

<P>
Not
applicable.
</P>

<P>
<A NAME="7"><B>7. Source Files</B></A>
</P>

<P>
All Procedure
Window source files are located in the SRC directory adecomm and begin with the
prefix “_pw”. The following table lists and describes the source files that
comprise Procedure Windows:
</P>


 
  
   
<P>
   Source File
</P>
   
   
   
<P>
   Description
</P>
   
   
  
 
 
  
<P>
  _pwattr.i
</P>
  
  
  
<P>
  Preprocessor defines and internal
  procedures used to manage Procedure Window attributes that contain persistent
  Procedure Window data.
</P>
  
  
 
 
  
<P>
  _pwchfnt.p
</P>
  
  
  
<P>
  Changes the font of all Procedure Windows
  with a specified font to a new specified font.
</P>
  
  
 
 
  
<P>
  _pwclose.p
</P>
  
  
  
<P>
  Executes the Procedure Window
  File&gt;Close command.
</P>
  
  
 
 
  
<P>
  _pwclosf.p
</P>
  
  
  
<P>
  Low-level routine to close a Procedure
  Window file.
</P>
  
  
 
 
  
<P>
  _pwcmpfl.p
</P>
  
  
  
<P>
  Compiles the contents of a Procedure
  Window editor widget or the contents of a disk file to check its syntax.
</P>
  
  
 
 
  
<P>
  _pwcomp.p
</P>
  
  
  
<P>
  Executes Procedure Window Compile menu
  commands.
</P>
  
  
 
 
  
<P>
  _pwcreat.p
</P>
  
  
  
<P>
  Creates the Persistent Procedure Window
  with Menubar, frame, and editor widget, and additional attributes used to
  hold persistent data. This also attaches default persistent triggers for
  WINDOW-CLOSE, WINDOW-RESIZE, HELP, and DROP-FILE-NOTIFY.
</P>
  
  
 
 
  
<P>
  _pwdelpw.p
</P>
  
  
  
<P>
  Deletes the Procedure Window widget and
  all its child widgets.
</P>
  
  
 
 
  
<P>
  _pwedit.p
</P>
  
  
  
<P>
  Executes the Procedure Window Edit menu
  commands and handles various other events when they occur in the editor
  widget, such as TAB, BACK-TAB, and END-ERROR.
</P>
  
  
 
 
  
<P>
  _pweditor.i
</P>
  
  
  
<P>
  Procedure Window support procedures.
  (Encrypted)
</P>
  
  
 
 
  
<P>
  _pwemdrp.p
</P>
  
  
  
<P>
  On the MENU-DROP event for a Procedure
  Window Edit menu or Popup Menu, set the sensitive state of the menu items.
</P>
  
  
 
 
  
<P>
  _pwexit.p
</P>
  
  
  
<P>
  Attempt to close all open Procedure
  Windows for a specified parent.
</P>
  
  
 
 
  
<P>
  _pwfchg.p
</P>
  
  
  
<P>
  Executes the File Changed Dialog, which
  asks the user to save changes made to a modified file before continuing some
  operation.
</P>
  
  
 
 
  
<P>
  _pwfile.p
</P>
  
  
  
<P>
  Executes the Procedure Window File menu
  commands.
</P>
  
  
 
 
  
<P>
  _pwfmod.p
</P>
  
  
  
<P>
  Returns TRUE if the Procedure Window has
  been modified; FALSE if it has not.
</P>
  
  
 
 
  
<P>
  _pwgeteh.p
</P>
  
  
  
<P>
  Returns the handle for any Procedure
  Window editor widget.
</P>
  
  
 
 
  
<P>
  _pwgetfh.p
</P>
  
  
  
<P>
  Returns the handle of the Procedure Window
  Editor Frame given a Procedure Window handle.
</P>
  
  
 
 
  
<P>
  _pwgetun.p
</P>
  
  
  
<P>
  Returns a Procedure Window Untitled procedure
  name.
</P>
  
  
 
 
  
<P>
  _pwgetwh.p
</P>
  
  
  
<P>
  Returns the Window handle for any widget.
  (File was necessary before WINDOW handle attribute was added to all widgets.)
</P>
  
  
 
 
  
<P>
  _pwglob.i
</P>
  
  
  
<P>
  Global defines for Procedure Windows.
  Currently defines only preprocessor values such as the “Procedure Window”
  name displayed in the title bar and the Procedure Window widget pool.
</P>
  
  
 
 
  
<P>
  _pwhelp.p
</P>
  
  
  
<P>
  Executes the Procedure Window Help menu
  commands.
</P>
  
  
 
 
  
<P>
  _pwin.p
</P>
  
  
  
<P>
  Intended to be a start-up routine called
  from Progress –p startup procedure to run Procedure Windows. For example, to
  open a list of files in Procedure Windows based on SESSION:PARAMETER. This
  procedure is not currently used by any ADE code.
</P>
  
  
 
 
  
<P>
  _pwmain.p
</P>
  
  
  
<P>
  The main program to call to open one or
  more Procedure Windows for editing procedure or include files, or for opening
  an Untitled procedure in a Procedure Window. 
</P>
  
  
 
 
  
<P>
  _pwmbar.p
</P>
  
  
  
<P>
  Creates a Procedure Window menu and
  returns its handle. The menu can be a menubar or popup menu.
</P>
  
  
 
 
  
<P>
  _pwnew.p
</P>
  
  
  
<P>
  Executes the Procedure Window File&gt;New
  command.
</P>
  
  
 
 
  
<P>
  _pwnewpw.p
</P>
  
  
  
<P>
  Executes the Procedure Window File&gt;New
  Procedure Window command.
</P>
  
  
 
 
  
<P>
  _pwopen.p
</P>
  
  
  
<P>
  Executes the Procedure Window
  File&gt;Open. command.
</P>
  
  
 
 
  
<P>
  _pwprint.p
</P>
  
  
  
<P>
  Executes the Procedure Window
  File&gt;Print command.
</P>
  
  
 
 
  
<P>
  _pwrdfl.p
</P>
  
  
  
<P>
  Reads a specified file into a Procedure
  Window editor widget and updates the window’s title bar.
</P>
  
  
 
 
  
<P>
  _pwresz.p
</P>
  
  
  
<P>
  Resizes the frame and editor widget for a
  Procedure Window after the Procedure Window has been resized.
</P>
  
  
 
 
  
<P>
  _pwrun.p
</P>
  
  
  
<P>
  Executes the Procedure Window
  Compile&gt;Run and Compile&gt;Check commands.
</P>
  
  
 
 
  
<P>
  _pwsavas.p
</P>
  
  
  
<P>
  Executes the Procedure Window File&gt;Save
  As command.
</P>
  
  
 
 
  
<P>
  _pwsave.p
</P>
  
  
  
<P>
  Executes the Procedure Window File&gt;Save
  command.
</P>
  
  
 
 
  
<P>
  _pwsavef.p
</P>
  
  
  
<P>
  Low-level routine to save editor contents
  to an operating system file. If saving to a remote WebSpeed agent, this
  program will save the editor contents to a local temp file only. See the file
  for details.
</P>
  
  
 
 
  
<P>
  _pwsrch.p
</P>
  
  
  
<P>
  Executes the Procedure Window Search menu
  commands.
</P>
  
  
 
 
  
<P>
  _pwwinst.p
</P>
  
  
  
<P>
  Sets the window state of all Procedure
  Windows that are children of a specified Procedure Window parent. For
  example, if the Procedure Editor “Minimize Before Run” setting is enabled,
  then all Procedure Windows opened from the Procedure Editor are minimized.
  Procedure Windows not opened from the Procedure Editor do not have their
  window state changed.
</P>
  
  
 


<P>
<A NAME="8"><B>8. Build Process and Requirements</B></A>
</P>

<P>
When making changes to Procedure Window include files, you
must recompile adecomm/_pw*.p files which include the changes files.
</P>

<P>
<A NAME="9"><B>9. Execution Methods</B></A>
</P>

<P>
Not
applicable.
</P>

<P>
<A NAME="10"><B>10. Test Requirements and Strategies</B></A>
</P>

<P>
If you follow the suggestions for building, and your
working directory appears first in your PROPATH, then testing is rather
straightforward.
</P>

<P>
<A NAME="11"><B>11. Supplementary Information</B></A>
</P>

<P>
Not
applicable.
</P>

<P>
<A NAME="12"><B>12. Related Documentation</B></A>
</P>

<P>
It is strongly recommended
that anyone wanting to modify Procedure Windows code read the following
Progress user documents and POSSE documents:
</P>

<P>
·
Progress Procedure Window Online Help
</P>

<P>
·
WS WebSpeed Workshop (for information about how
procedure windows handle remote file management)
</P>






</SPAN>