<SPAN CLASS="Text1">

<P>
<B>Section Editor</B><BR>
<B>Beta Draft</B><BR>
<B>Author:</B> (Author's Name)<BR>
<B>Date Last Updated:</B> (Date)<BR>
<B>Scheduled Release:</B> (Release Number)
</P>

<HR SIZE="1" NOSHADE>

<P>
<B>Revision History</B>
The following revisions have been made to this document:<BR>
<BR>
Date: (date)	<BR>
Revision: (rev-no)	<BR>
Developer: (developer)	<BR>
Summary of Changes: (summary)
</P>

<HR SIZE="1" NOSHADE>

<P>
Copyright &copy; 2000 by Progress Software Corporation ("PSC"), 14 Oak Park, Bedford, MA 01730, 
and other contributors as listed below. All Rights Reserved.
</P>

<P>
The Initial Developer of the Original Code is PSC. The Original Code is Progress IDE code 
released to open source December 1, 2000.
</P>

<P>
The contents of this file are subject to the Possenet Public License Version 1.0 (the "License"); 
you may not use this file except in compliance with the License. A copy of the License is available 
as of the date of this notice at <A HREF="http://www.possenet.org/license.html">http://www.possenet.org/license.html</A>
</P>

<P>
Software distributed under the License is distributed on an "AS IS" basis, WITHOUT WARRANTY OF 
ANY KIND, either express or implied. You should refer to the License for the specific language 
governing rights and limitations under the License. 
</P>

<HR SIZE="1" NOSHADE>

<P>
<B>Contributors</B>
<BR>
Jane Contributor, Joe Contributor
</P>

<HR SIZE="1" NOSHADE>

<P>
<B>Contents</B>
</P>


<P>
1. <A HREF="#1">Overview</A><BR>
2. <A HREF="#2">Architecture</A><BR>
2.1 <A HREF="#2.1">Source File Descriptions and Program Call Structure</A><BR>
2.2 <A HREF="#2.2">How the AppBuilder Runs Section Editor Functionality</A><BR>
2.3 <A HREF="#2.3">Section Editor Command Calls</A><BR>
2.4 <A HREF="#2.4">User Interface and Internal Structures</A><BR>
3. <A HREF="#3">Primary Data Structures</A><BR>
3.1 <A HREF="#3.1">Variables</A><BR>
3.2 <A HREF="#3.2">Temp-Tables</A><BR>
3.2.1 <A HREF="#3.2.1">Details about the _tSPECIAL and the _tOFFSET Fields</A><BR>
3.2.2 <A HREF="#3.2.2">Details about the _SEW Temp-Table</A><BR>
4. <A HREF="#4">Primary Algorithms and Processes</A><BR>
4.1 <A HREF="#4.1">File Menu</A><BR>
4.2 <A HREF="#4.2">Edit Menu</A><BR>
4.3 <A HREF="#4.3">Insert Menu</A><BR>
4.4 <A HREF="#4.4">Search Menu</A><BR>
4.5 <A HREF="#4.5">Compile Menu</A><BR>
4.6 <A HREF="#4.6">Help Menu</A><BR>
5. <A HREF="#5">Advanced Topics</A><BR>
5.1 <A HREF="#5.1">Editing the Section Editor Using the AppBuilder</A><BR>
5.1.1 <A HREF="#5.1.1">Procedure to Delete a Persistent Version of _semain.w</A><BR>
5.2 <A HREF="#5.2">Multiple Section Editor Windows</A><BR>
5.2.1 <A HREF="#5.2.1">Section Editor Preferences</A><BR>
5.2.2 <A HREF="#5.2.2">Shared Variable hSecEd</A><BR>
5.2.3 <A HREF="#5.2.3">Section Editor Procedure Handle</A><BR>
5.2.4 <A HREF="#5.2.4">Call_sew_getHandle Procedure</A><BR>
5.2.5 <A HREF="#5.2.5">Call_sew_setHandle Procedure</A><BR>
5.2.6 <A HREF="#5.2.6">check_UIB_current_window Procedure</A><BR>
5.2.7 <A HREF="#5.2.7 ">Section Editor ENTRY Trigger</A><BR>
5.2.8 <A HREF="#5.2.8">Design Window Focus</A><BR>
5.2.9 <A HREF="#5.2.9 ">Section Editor Window Placement</A><BR>
5.2.10 <A HREF="#5.2.10">File Close and Close Windows</A><BR>
6. <A HREF="#6">Dependencies</A><BR>
7. <A HREF="#7">Source Files</A><BR>
8. <A HREF="#8">Build Process and Requirements</A><BR>
9. <A HREF="#9">Execution Methods</A><BR>
10. <A HREF="#10">Test Requirements and Strategies</A><BR>
11. <A HREF="#11">Supplementary Information</A><BR>
12. <A HREF="#12">Related Documentation</A>
</P>










<P><A NAME="1"><B>1
Overview </B></A></P>

<P>
The AppBuilder’s Section Editor allows you to edit the 4GL
code sections of an AppBuilder procedure file. There are three ways to access
the Section Editor's functionality: menu options, mouse operations, and
keyboard commands.
</P>

<P><A NAME="2"><B>
2
Architecture
</B></A></P>

<P>
This section describes general architectural
considerations about the Section Editor, including:
</P>

<P>
·
Source file descriptions and program call structure
</P>

<P>
·
AppBuilder and Section Editor functionality
</P>

<P>
·
Section Editor command calls
</P>

<P>
·
Section Editor startup processing
</P>

<P>
·
User interface and internal structures
</P>


<P><A NAME="2.11"><B>2.1 Source File Descriptions
and Program Call Structure
</B></A></P>

<P>
Procedure file _semain.w creates the Section Editor’s main
window, user interface elements, event triggers, primary data structures, and
manages the events to the main window. It is a persistently run procedure and
is located in the adeuib directory. It primarily calls internal procedures
defined in _seprocs.i (which is included into _semain.w) from triggers it
defines to respond to various user interface events. Procedure file _semain.w
is an AppBuilder file; it is recommended that you edit it using the AppBuilder.
Include file _seprocs.i is a freeform include file and you can edit it using a
Procedure Window or the Procedure Editor.
</P>

<P><A NAME="2.2"><B>2.2 How the AppBuilder Runs
Section Editor Functionality
</B></A></P>

<P>
The AppBuilder runs Section Editor functionality through
the AppBuilder’s internal procedure call_sew (defined in uibmproa.i). Procedure
call_sew accepts character input parameter p_secommand, which represents the
Section Editor command that the AppBuilder wants to execute. Procedure call_sew
in turn runs Section Editor internal procedure SecEdWindow to execute the
requested Section Editor functionality.
</P>

<P><A NAME="2.3"><B>2.3 Section Editor Command
Calls
</B></A></P>

<P>
The Section Editor’s functionality is primarily accessed
using its command call interface. The Section Editor commands are character
strings of the form “SE_COMMAND”. The Section Editor processes command calls
through its internal procedure SecEdWindow (defined in _seprocs.i). 
</P>

<P>
The following Table lists the Section Editor commands used
to run Section Editor functionality. 
</P>

<P>
Note:
In the following Table descriptions, the acrynom SEW stands for Section Editor
Window. 
</P>




<P>
Table 1. Section Editor Command
Calls to Procedure SecEdWindow
</P>


 
  
   
<P>
   Command
</P>
   
   
<P>
   Description
</P>
   
  
 
 
  
<P>
  “” (Null)
</P>
  
  
<P>
  Opens or changes this SEW to a specific code
  section.
</P>
  
 
 
  
<P>
  SE_OPEN
</P>
  
  
<P>
  Opens this Section Editor window.
</P>
  
 
 
  
<P>
  SE_ERROR
</P>
  
  
<P>
  Displays the code section of this SEW that contains
  a compile/syntax error.
</P>
  
 
 
  
<P>
  SE_STORE
</P>
  
  
<P>
  Stores the current code section of this SEW to
  _TRG record, regardless of what the current design window is in AppBuilder.
  This command is only called when closing all windows in AppBuilder, which is
  where AppBuilder wants to store the code of a SEW even if the AppBuilder’s
  current design window is different from the called one. (for example,
  multiple Section Editor window’s open).
</P>
  
 
 
  
<P>
  SE_STORE_WIN
</P>
  
  
<P>
  Stores current code section of this SEW to
  _TRG record when this Section Editor's design window is the current
  AppBuilder design window.
  For example, you can use this call before a
  design window is run or before a code preview.
</P>
  
 
 
  
<P>
  SE_STORE_SELECTED
</P>
  
  
<P>
  Stores the current code section
  of this Section Editor window to _TRG record when the current Section Editor
  widget is selected in the design window. This command is used for Cut, Copy,
  Duplicate, Delete, and Copy to File in situations where the AppBuilder wants
  to store the code only if its one of the selected widgets for the AppBuilder
  Edit command.
</P>
  
 
 
  
<P>
  SE_PROPS
</P>
  
  
<P>
  Updates this SEW display and publishes the
  &quot;SE_UPDATE_WIDGETS&quot; event. This call is used in cases where a
  widget name or label changes in AppBuilder. 
  For example, if a design window's file name
  changes or a widget name changes, the AppBuilder sends this call to that
  design window's SEW, which then refreshes its own display, as needed.
</P>
  
 
 
  
<P>
  SE_HIDE
</P>
  
  
<P>
  Hides this SEW if it is currently visible.
  This is done anytime the AppBuilder becomes disabled.
  For example, the AppBuilder hides all SEW's
  before a design window is run.
  The SEW adds the prefix &quot;SE_HIDDEN &quot;
  to its title to indicate the window was visible and has been requested to
  hide itself. Later, when the AppBuilder issues the SE_VIEW command, the SEW
  checks its title for the prefix:
  ·
  If the prefix is there, the SEW is made visible and
  the prefix is removed.
  ·
  If the prefix is not there, the SEW does not make
  itself visible. This prevents SEW's from being made visible when they were
  not before any disabling of the AppBuilder.
</P>
  
 
 
  
<P>
  SE_VIEW
</P>
  
  
<P>
  Makes this SEW visible if it was visible
  before the AppBuilder was disabled. 
</P>
  
<P>
  Note:
  See the SE_HIDE
  Command in this table for additional information.
</P>
  
 
 
  
<P>
  SE_ADD
</P>
  
  
<P>
  Adds an object name to this
  SEW's widget list. Publishes the &quot;SE_UPDATE_WIDGETS&quot; event, too.
</P>
  
 
 
  
<P>
  SE_DELETE
</P>
  
  
<P>
  Deletes
  an object from this SEW's widget list. Changes the SEW to edit a section of
  the new current object is in the design window.
  For
  example, the SEW is open to a trigger for button in a design window. The user
  deletes the button. The AppBuilder switches to some other object as the
  current object makes the SE_DELETE call to the appropriate SEW. The SEW
  removes the button from its widget list and changes to the Triggers section
  for the new current widget in the design window. 
</P>
  
 
 
  
<P>
  SE_UNDO
</P>
  
  
<P>
  Adds an object name to this
  SEW's widget list and publishes the &quot;SE_UPDATE_WIDGETS&quot; event.
  SE_UNDO is generated when
  choosing the Edit-&gt;Undo option in the AppBuilder, such as when undoing the
  cut or delete of an object in a design window. The undo of cut and delete are
  the only undo events that affect the widget list used by the Section Editor
  (widgets are added to the list).
</P>
  
 
 
  
<P>
  SE_CLOSE
</P>
  
  
<P>
  Closes this SEW. This is the same as choosing
  the Section-&gt;Close menu option. If the multiple SEW preference is active,
  the deletes the SEW persistent procedure and its widgets.
</P>
  
<P>
  Calls Section Editor internal procedure
  SEClose to perform the actual close operation. For this command only, SEClose
  publishes the &quot;SE_CLOSE&quot; event. The Code References window detects
  this to see if it should close, too.
</P>
  
 
 
  
<P>
  SE_CLOSE_SELECTED
</P>
  
  
<P>
  Closes this SEW only if it is the SEW for the
  current AppBuilder design window. Does not delete the SEW persistent
  procedure, or its widgets.
</P>
  
<P>
  For example: The AppBuilder passes this
  command along when a design window is switched between alternate layouts.
  That design window's SEW is closed by the AppBuilder.
</P>
  
 
 
  
<P>
  SE_EXIT
</P>
  
  
<P>
  Closes this SEW. This is the
  same as choosing the Section-&gt;Close menu option. This command always
  deletes the SEW persistent procedure and its widgets.
  Calls Section Editor internal
  procedure SEClose to perform the actual exit operation. For this command
  only, SEClose publishes the &quot;SE_EXIT&quot; event. The Code References
  window detects this to see if it should close, too.
</P>
  
 


<P><A NAME="2.4"><B>2.4 User Interface and
Internal Structures
</B></A></P>

<P>
The
following table lists the Section Editor user interface elements and the
internal program variables that represent that interface element.
</P>

<P>
Table
2. User Interface
Elements and Their Program Variables
</P>


 
  
   
<P>
   User Interface Element
</P>
   
   
   
<P>
   Widget Type
</P>
   
   
   
<P>
   Description
</P>
   
   
  
 
 
  
<P>
  Section
  Editor Window
</P>
  
  
  
<P>
  Window
</P>
  
  
  
<P>
  h_sewin
  handle variable
</P>
  
  
 
 
  
<P>
  Section
</P>
  
  
  
<P>
  Combo
  Box
</P>
  
  
  
<P>
  isection
  character widget variable
</P>
  
  
 
 
  
<P>
  ON
</P>
  
  
  
<P>
  Combo
  Box
</P>
  
  
  
<P>
  se_event
  character widget variable
</P>
  
  
 
 
  
<P>
  OF
</P>
  
  
  
<P>
  Combo
  Box
</P>
  
  
  
<P>
  wname
  character widget variable
</P>
  
  
 
 
  
<P>
  Name
</P>
  
  
  
<P>
  Combo
  Box
</P>
  
  
  
<P>
  se_event
  (Procedure names and Function names)
</P>
  
  
 
 
  
<P>
  List
</P>
  
  
  
<P>
  Button
</P>
  
  
  
<P>
  btn_List
  widget variable
</P>
  
  
 
 
  
<P>
  New
</P>
  
  
  
<P>
  Button
</P>
  
  
  
<P>
  btn_New
  widget variable
</P>
  
  
 
 
  
<P>
  Insert
  Call
</P>
  
  
  
<P>
  Button
</P>
  
  
  
<P>
  btn_Pcall
  widget variable
</P>
  
  
 
 
  
<P>
  Rename
</P>
  
  
  
<P>
  Button
</P>
  
  
  
<P>
  btn_Rename
  widget variable
</P>
  
  
 
 
  
<P>
  DB
  Required
</P>
  
  
  
<P>
  Checkbox
</P>
  
  
  
<P>
  db_required
  logical widget variable
</P>
  
  
 
 
  
<P>
  Private
</P>
  
  
  
<P>
  Checkbox
</P>
  
  
  
<P>
  private_block
  logical widget variable
</P>
  
  
 
 
  
<P>
  Read-Only
</P>
  
  
  
<P>
  Text
</P>
  
  
  
<P>
  read_only
  text widget variable
</P>
  
  
 
 
  
<P>
  Edit
  Area
</P>
  
  
  
<P>
  Editor
</P>
  
  
  
<P>
  txt
  IN FRAME f_edit – editor widget reference
</P>
  
  
 
 
  
<P>
  Menubar
</P>
  
  
  
<P>
  Menu
</P>
  
  
  
<P>
  MENU
  mnb_SectionEd
</P>
  
  
 
 
  
<P>
  Popup
  menu
</P>
  
  
  
<P>
  Menu
</P>
  
  
  
<P>
  Statically
  defined in adecomm/dedit.i
</P>
  
  
 


<P><A NAME="3"><B>3
Primary Data Structures
</B></A></P>

<P>
The Section Editor uses a combination of variables,
work-tables, and an editor widget as its primary data structures. These
elements are discussed in this section.
</P>

<P><A NAME="3.1"><B>3.1 Variables
</B></A></P>

<P>
The following table lists several important variables that
the Section Editor defines. These variables are used throughout the Section
Editor code.
</P>

<P>
Table 3. Key Variables Defined by the Section Editor
</P>


 
  
<P>
  Variable Name
</P>
  
  
<P>
  Data Type
</P>
  
  
<P>
  Description
</P>
  
 
 
  
<P>
  win_recid
</P>
  
  
<P>
  Recid
</P>
  
  
<P>
  Record id of the design window
  for which this Section Editor is open.
  The recid is that of an _U
  record.
</P>
  
 
 
  
<P>
  h_sewin
</P>
  
  
<P>
  Handle
</P>
  
  
<P>
  Handle to Section Editor window
</P>
  
 
 
  
<P>
  h_win_trig
</P>
  
  
<P>
  Handle
</P>
  
  
<P>
  Handle to design window for
  which the Section Editor is editing code.
</P>
  
 


<P>
The following table lists several important shared
variables defined by AppBuilder in adeuib/sharvars.i that are used to manage
the Section Editor, or that the Section Editor references in executing its
behavior.
</P>

<P>
Table 4. Key Shared Variables
Defined by AppBuilder (sharvars.i) for the Section Editor
</P>


 
  
<P>
  Variable Name
</P>
  
  
<P>
  Data Type
</P>
  
  
<P>
  Description
</P>
  
 
 
  
<P>
  se_section
</P>
  
  
<P>
  Character
</P>
  
  
<P>
  Identifies
  the general class, or type, of code section to which a specific code section
  belongs.
  One of
  the following values: _CUSTOM, _CONTROL, _PROCEDURE, _FUNCTION:
  ·
  The types of _CUSTOM sections (Definitions, Main
  Block, and Library) are indicated by se_event.
  ·
  _CONTROL value indicates the Triggers section, with
  se_event being the specific trigger.
  ·
  _PROCEDURE and _FUNCTION values indicate Procedures
  and Functions sections, with se_event being the name of the specific
  procedure or function.
</P>
  
 
 
  
<P>
  se_recid
</P>
  
  
<P>
  Recid
</P>
  
  
<P>
  Identifies the type of record id
  of the widget that owns the code section that the SEW is editing. 
  The following details describe
  how the recid is determined:
  ·
  If the section (se_section) is a _CONTROL (Triggers)
  section, then the recid is that of a _U record for most widgets. If the
  widget is a browse or data-object column, then the recid is that of a _BC
  record.
  ·
  All other sections are considered under the ownership
  of the design window, and se_recid takes on win_recid's value (a recid of a
  _U record). 
</P>
  
 
 
  
<P>
  se_event
</P>
  
  
<P>
  Character
</P>
  
  
<P>
  Identifies a specific code block
  of a general section (se_section). The types of code blocks are determined as
  follows:
  ·
  When the section is Triggers, its value is the event
  name.
  ·
  When the section is Definitions, its value is
  _DEFINITIONS.
  ·
  When the section is Main Block, its value is
  _MAIN-BLOCK.
  ·
  When the section is Library, its value is
  _INCLUDED-LIBRARIES.
  ·
  When the section is Procedures or Functions, its
  value is the procedure name or function name. 
</P>
  
 
 
  
<P>
  _dblclick_section_ed
</P>
  
  
<P>
  Logical
</P>
  
  
<P>
  Determines if a property sheet
  or the section editor should come up on the double click of an object.
</P>
  
 
 
  
<P>
  _multiple_section_ed
</P>
  
  
<P>
  Logical
</P>
  
  
<P>
  Determines if multiple Section
  Editors will be displayed. The default value is False.
</P>
  
 
 
  
<P>
  _default_function_type
</P>
  
  
<P>
  Character
</P>
  
  
<P>
  Determines what the default
  return type is when creating a new function in the Section Editor. The
  initial value is Character. The setting is saved to the AppBuilder section of
  the Environment file.
</P>
  
 
 
  
<P>
  err_msg
</P>
  
  
<P>
  Character
</P>
  
  
<P>
  Identifies the first error
  message from the last compile attempt in the AppBuilder. The Section Editor
  displays this message, as needed.
</P>
  
 
 
  
<P>
  _err_recid
</P>
  
  
<P>
  Recid
</P>
  
  
<P>
  Identifies the record ID of the
  trigger temp-table record (_TRG) that contains the trigger code that caused a
  syntax error when using the Compile menu options in the AppBuilder or Section
  Editor.
</P>
  
 
 
  
<P>
  _h_cur_widg
</P>
  
  
<P>
  Handle
</P>
  
  
<P>
  Indicates the handle of the
  currently active widget. 
</P>
  
 
 
  
<P>
  _h_mlmgr
</P>
  
  
<P>
  Handle
</P>
  
  
<P>
  Indicates the Procedure handle
  of the Method Library Manager. See the AB Method Libraries Open Source
  document for more information.
</P>
  
 
 
  
<P>
  _h_uib
</P>
  
  
<P>
  Handle
</P>
  
  
<P>
  Identifies the handle of the
  AppBuilder's main procedure.
</P>
  
 
 
  
<P>
  _h_win
</P>
  
  
<P>
  Handle
</P>
  
  
<P>
  Identifies the handle of the
  current design window in AppBuilder.
</P>
  
 
 
  
<P>
  _h_CodeRefs
</P>
  
  
<P>
  Handle
</P>
  
  
<P>
  Identifies the procedure handle
  of the Insert Code References window.
</P>
  
 


<P><A NAME="3.2"><B>3.2 Temp-Tables
</B></A></P>

<P>
Temp-table
_TRG stores all code sections for all design windows open in the AppBuilder,
one _TRG record for each code section. _TRG temp-table is defined in include
file triggers.i, contained in the adeuib directory. 
</P>

<P>
Table
5. Fields of the _TRG Temp-Table, identifies and briefly describes most of the
fields of the _TRG Temp-Table. The _tSPECIAL and _tOFFSET fields are thoroughly
described separately in Table 6. 
</P>

<P>
Table
5. Fields of the
_TRG Temp-Table
</P>


 
  
   
<P>
   Field Name
</P>
   
   
   
<P>
   Data Type
</P>
   
   
   
<P>
   Description
</P>
   
   
  
 
 
  
<P>
  _tSECTION
</P>
  
  
  
<P>
  Character
</P>
  
  
  
<P>
  Identifies
  the general class or type of code section to which a specific code section
  belongs.
  Note: .See the se_section
  variable information in Table 3. Key Shared Variables Defined by AppBuilder
  (sharvars.i) for Section Editor in section 3.1Variables
</P>
  
  
 
 
  
<P>
  _pRECID
</P>
  
  
  
<P>
  Recid
</P>
  
  
  
<P>
  Identifies
  the record id (_P) of the design window procedure owning the code section.
</P>
  
  
 
 
  
<P>
  _wRECID
</P>
  
  
  
<P>
  Recid
</P>
  
  
  
<P>
  Identifies
  the record id (_U or _BC) of the widget that owns the code section.
  Note: See se_recid in
  Table 6. Key
  Shared Variables Defined by AppBuilder (sharvars.i) for the Section Editor.
</P>
  
  
 
 
  
<P>
  _seq
</P>
  
  
  
<P>
  --
</P>
  
  
  
<P>
  Unused
  field
</P>
  
  
 
 
  
<P>
  _tEVENT
</P>
  
  
  
<P>
  Character
</P>
  
  
  
<P>
  Identifies
  a specific code block of the general section. 
  Note: See the se_event
  variable information in Table 3. Key Shared Variables Defined by AppBuilder
  (sharvars.i) for Section Editor in section 3.1Variables.
</P>
  
  
 
 
  
<P>
  _tCODE
</P>
  
  
  
<P>
  Character
</P>
  
  
  
<P>
  Stores
  a section’s code block. A value of unknown (?) indicates this is a special
  code section and its actual value is a generated one. 
</P>
  
  
 
 
  
<P>
  _tOFFSET-END
</P>
  
  
  
<P>
  Integer
</P>
  
  
  
<P>
  Obsolete
  field. Was at one time used with _tOFFSET for locating a code section with a
  compile error.
</P>
  
  
 
 
  
<P>
  _STATUS
</P>
  
  
  
<P>
  Character
</P>
  
  
  
<P>
  Identifies
  the status indicator of a code section. The default value of “NORMAL”
  indicates the code section is active and available for editing or code
  generating. A “DELETED” value indicates the section has been deleted and is
  not to be displayed for editing or used in generating the file.
</P>
  
  
 
 
  
<P>
  _xRECID
</P>
  
  
  
<P>
  Recid
</P>
  
  
  
<P>
  Links
  a code section record (_TRG) to an XFTR record (_XFTR) defined for it.
</P>
  
  
 
 
  
<P>
  _tLocation
</P>
  
  
  
<P>
  Integer
</P>
  
  
  
<P>
  Stores
  an _XFTR location id so that a code section’s XFTR’s can be organized by
  where in the file an XFTR is stored. Preprocessor definitions in
  adeuib/pre_prec.i specify the location id’s
</P>
  
  
 
 
  
<P>
  _tTYPE
</P>
  
  
  
<P>
  Character
</P>
  
  
  
<P>
  Stores
  an AppBuilder widget type defined by the universal widget record field
  _U._TYPE.
  Examples:
  BUTTON, MENUBAR, QUERY
</P>
  
  
 
 
  
<P>
  _DB-REQUIRED
</P>
  
  
  
<P>
  Logical
</P>
  
  
  
<P>
  Identifies
  a code section as to whether or not it requires a connected database to
  compile successfully.
</P>
  
  
 
 
  
<P>
  _PRIVATE-BLOCK
</P>
  
  
  
<P>
  Logical
</P>
  
  
  
<P>
  Identifies
  a code section as to whether or not it is a private code block.
</P>
  
  
 


<P><A NAME="3.2.1"><B>3.2.1 Details
about the _tSPECIAL and the _tOFFSET Fields
</B></A></P>

<P>
This
section discusses the
</P>

<P>
·
_tSPECIAL field
</P>

<P>
·
_tOFFSET field
</P>

<P>
3.2.1.1
_tSPECIAL Field and Special Handling Status
</P>

<P>
The
_tSPECIAL field, a character data type, indicates whether or not a code section
requires special handling by the AppBuilder or Section Editor. 
</P>




<P>
3.2.1.1.1 Code
Sections that Do Not Require Special Handling
</P>

<P>
Code
sections that don't require special handling are those that the user can edit
and for which the AppBuilder or Section Editor provides no special handling.
Examples of code sections that do not require special handling include: the
Definitions and Main Block sections, triggers, and user-created procedures and
functions. The _tSPECIAL field has a value of unknown (?) for such code
sections; any other value indicates the section does require special handling.
</P>

<P>
3.2.1.1.2 Code
Sections that Do Require Special Handling
</P>

<P>
Code
sections that require special handling are AppBuilder-maintained procedures,
such as enable_ui and disable_ui. Each AppBuilder-maintained procedure has its
own unique internal _tSPECIAL value. 
</P>

<P>
For
example, _ENABLE-UI is the value used to indicate that the AppBuilder and SEW
handle the code section as the AppBuilder-maintained enable_ui procedure. This
enables such features as Read-Only and automatic code generation for the displayed
code section.
</P>

<P>
3.2.1.1.1.1. User-editable Code Sections that Require
Special Handling
</P>

<P>
The
following table identifies and describes code sections that require special
handling, but that the user can edit. 
</P>

<P>
Table
6. User-editable Code Sections that Require Special Handling
</P>


 
  
   
<P>
   User-editable Code Sections that
   Require Special Handling
</P>
   
   
   
<P>
   Description
</P>
   
   
  
 
 
  
<P>
  OCX
  events
</P>
  
  
  
<P>
  The
  _tSPECIAL values are prefixed with &quot;OCX.&quot; and are of the form
  &quot;OCX.event&quot;. For example, &quot;OCX.click&quot;.
</P>
  
  
 
 
  
<P>
  WebSpeed
  event procedures
</P>
  
  
  
<P>
  The
  _tSPECIAL values are prefixed with &quot;WEB.&quot; and are of the form
  &quot;WEB.event&quot;.
</P>
  
  
 
 
  
<P>
  Free-Form
  Query events Open-Query and Display-Fields
</P>
  
  
  
<P>
  For
  Display-Fields, _tSPECIAL value is &quot;_DISPLAY-FIELDS&quot;. For
  Open-Query, _tSPECIAL value is &quot;_OPEN-QUERY&quot;.
</P>
  
  
 


<P>
3.2.1.2
_tOFFSET Field And AppBuilder Processing Details
</P>

<P>
The
_tOFFSET field, an integer data type, stores the beginning offsets of a code
section when a procedure file is generated (for example: check syntax, run,
debug, code preview, save, and so forth).
</P>

<P>
The
AppBuilder uses the offset 
</P>

<P>
·
To identify the code section in which a compile error
occurs 
</P>

<P>
·
To display that section in the Section Editor, or
position the cursor in the Code Preview window to show a syntax error.
</P>

<P>
The
file that the AppBuilder generates is often comprised of more than just the code
sections accessible to the user in the Section Editor. Therefore, as the
AppBuilder writes each code section of a procedure file, it stores the
section’s beginning byte offsets with respect to the generated file. If a
compile error is detected during file generation, the Section Editor compares
the COMPILER:FILE-OFFSET attribute with _tOFFSET field to determine if a code
section contains the line with the error. 
</P>

<P>
Note: See the check_store_trg and set_cursor
procedures, defined in adeuib/_seprocs.i, for examples of the use of _tOFFSET,
and procedure adeshar/_gen4gl.p to see how _tOFFSET’s values are calculated.
</P>

<P><A NAME="3.2.2"><B>3.2.2 Details
about the _SEW Temp-Table
</B></A></P>

<P>
The
Section Editor defines and uses work-table _SEW (defined in _semain.w). The
Section Editor creates one _SEW record to track its current design window and
code section information. The following table describes the fields in _SEW.
</P>

<P>
Table 7. Key Fields of the _SEW Temp-Table
</P>


 
  
   
<P>
   Field Name
</P>
   
   
   
<P>
   Data Type
</P>
   
   
   
<P>
   Description
</P>
   
   
  
 
 
  
<P>
  _psection
</P>
  
  
  
<P>
  Character
</P>
  
  
  
<P>
  The
  general class or type of code section to which a specific code section
  belongs. See the se_section variable information in Table 3. .Key Shared
  Variables Defined by AppBuilder (sharvars.i) for Section Editor in section 3.1Variables.
</P>
  
  
 
 
  
<P>
  _precid
</P>
  
  
  
<P>
  Recid
</P>
  
  
  
<P>
  Identifies
  the recid (_U or _BC) of the widget that owns the code section. See se_recid
  in Table 3. Key Shared Variables Defined by AppBuilder (sharvars.i) for
  Section Editor in section 3.1Variables.able “Key Shared Variables”.
</P>
  
  
 
 
  
<P>
  _pevent
</P>
  
  
  
<P>
  Character
</P>
  
  
  
<P>
  Identifies
  a specific code block of the general section. See se_event in Table 3. Key
  Shared Variables Defined by AppBuilder (sharvars.i) for Section Editor in
  section 3.1Variables.
</P>
  
  
 
 
  
<P>
  _TRG_Recid
</P>
  
  
  
<P>
  Recid
</P>
  
  
  
<P>
  Identifies
  the recid of the _TRG record for current code section of the Section Editor
  window.
</P>
  
  
 
 
  
<P>
  _U_Recid
</P>
  
  
  
<P>
  Recid
</P>
  
  
  
<P>
  Holds same value as
  _precid. Not widely used.
</P>
  
  
 
 
  
<P>
  _hwin
</P>
  
  
  
<P>
  Handle
</P>
  
  
  
<P>
  Identifies
  the window handle to this SEW's design window. See win_recid in .Table 3.
  .Key Shared Variables Defined by AppBuilder (sharvars.i) for Section Editor
  in section 3.1Variables.
</P>
  
  
 


<P><A NAME="4"><B>4
Primary Algorithms and Processes
</B></A></P>

<P>
This section 
</P>

<P>
·
Describes the Section Editor menu 
</P>

<P>
·
Presents information about the procedure associated
with each menu item.
</P>

<P>
Note:
Unless otherwise noted, all procedures are defined in adeuib/_seprocs.i. 
</P>

<P><A NAME="4.1"><B>4.1 File Menu
</B></A></P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
   (File)
</P>
   
  
 
 
  
<P>
  Print Section
</P>
  
  
<P>
  PrintSection
</P>
  
 
 
  
<P>
  Close Window
</P>
  
  
<P>
  SEClose (INPUT
  &quot;SE_CLOSE&quot;:u).
</P>
  
 





<P><A NAME="4.2"><B>4.2 Edit Menu
</B></A></P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
   (File)
</P>
   
  
 
 
  
<P>
  Undo
</P>
  
  
<P>
  EditUndo (adecomm/pedit.i)
</P>
  
 
 
  
<P>
  Undo All
</P>
  
  
<P>
  UndoChange
</P>
  
 
 
  
<P>
  Cut
</P>
  
  
<P>
  EditCut (adecomm/pedit.i)
</P>
  
 
 
  
<P>
  Copy
</P>
  
  
<P>
  EditCopy (adecomm/pedit.i)
</P>
  
 
 
  
<P>
  Paste
</P>
  
  
<P>
  EditPaste (adecomm/pedit.i)
</P>
  
 
 
  
<P>
  Delete Definitions / Trigger
  /Main Block /Procedure / Function
</P>
  
  
<P>
  DeleteBlock
</P>
  
 
 
  
<P>
  Format Selection
  Indent
  Unindent
  Comment
  Uncomment
</P>
  
  
<P>
  Submenu access to formatting
  options.
  ApplyTAppBuilder (adecomm/pedit.i)
  ApplyBackTAppBuilder (adecomm/pedit.i)
  CommentSelection (h_Editor, YES) (ade comm/pedit.i)
  CommentSelection (h_Editor NO) (ade comm/pedit.i)
</P>
  
 


<P><A NAME="4.3"><B>4.3 Insert Menu
</B></A></P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
   (File)
</P>
   
  
 
 
  
<P>
  Database Fields
</P>
  
  
<P>
  InsertDBFields
</P>
  
 
 
  
<P>
  Event Name
</P>
  
  
<P>
  InsertEventName
</P>
  
 
 
  
<P>
  Procedure Call
</P>
  
  
<P>
  InsertProcName
</P>
  
 
 
  
<P>
  Preprocessor 
  Name
</P>
  
  
<P>
  InsertPreProcName
</P>
  
 
 
  
<P>
  Query
</P>
  
  
<P>
  InsertQuery
</P>
  
 
 
  
<P>
  Object Name
</P>
  
  
<P>
  InsertWidgetName
</P>
  
 
 
  
<P>
  File Contents
</P>
  
  
<P>
  insert_file
  (&quot;CONTENTS&quot;:U, txt:HANDLE IN FRAME f_edit).
</P>
  
 
 
  
<P>
  File Name
</P>
  
  
<P>
  insert_file (&quot;NAME&quot;:U,
  txt:HANDLE IN FRAME f_edit).
</P>
  
 





<P><A NAME="4.4"><B>4.4 Search Menu
</B></A></P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
   (File)
</P>
   
  
 
 
  
<P>
  Find
</P>
  
  
<P>
  FindText (adecomm/psearch.i)
</P>
  
 
 
  
<P>
  Find Next
</P>
  
  
<P>
  FindNext (adecomm/psearch.i)
</P>
  
 
 
  
<P>
  Find Previous
</P>
  
  
<P>
  FindPrev (adecomm/psearch.i)
</P>
  
 
 
  
<P>
  Replace
</P>
  
  
<P>
  Trigger:
  ON CHOOSE OF MENU-ITEM m_Replace (_semain.w).
  Does call
  ReplaceText (adecomm/psearch.i), but other coding is necessary to support
  Search All Sections option.
</P>
  
 


<P><A NAME="4.5"><B>4.5 Compile Menu
</B></A></P>


 
  
   
<P>
   Menu
   Item
</P>
   
   
<P>
   Procedure
   (File)
</P>
   
  
 
 
  
<P>
  Check Syntax
</P>
  
  
<P>
  Check Syntax 
</P>
  
 


<P><A NAME="4.6"><B>4.6 Help Menu
</B></A></P>


 
  
   
<P>
   Menu
   It
</P>
   
   
<P>
   Procedure
   (File)
</P>
   
  
 
 
  
<P>
  Press F1 in Edit Area
</P>
  
  
<P>
  EditHelp (adecomm/pedit.i)
</P>
  
 
 
  
<P>
  Help Topics
</P>
  
  
<P>
  RUN adecomm/_adehelp.p
  (INPUT &quot;AB&quot;:u, INPUT
  &quot;TOPICS&quot;:u,
   IPUT
  {&amp;Section_Editor_Contents} , INPUT ?)
</P>
  
 
 
  
<P>
  Section Editor Help /
  F1 in edit area
</P>
  
  
<P>
  RUN se_help (INPUT 0). Displays
  Section Editor window help if no text is selected. If text is selected,
  displays syntax help on selection.
</P>
  
 
 
  
<P>
  Messages
</P>
  
  
<P>
  RUN prohelp/ _msgs.p
</P>
  
 
 
  
<P>
  Recent Messages
</P>
  
  
<P>
  RUN prohelp/ _rentmsg.p
</P>
  
 


<P><A NAME="5"><B>5
Advanced Topics
</B></A></P>

<P><A NAME="5.1"><B>5.1 Editing the Section
Editor Using the AppBuilder
</B></A></P>

<P>
The
file used to run the Section Editor, adeuib/_semain.w, is an AppBuilder
procedure file. Progress recommends that you use the AppBuilder to edit it. If
you change _semain.w, or its included procedure file adeuib/_seprocs.i, and
want to test the changes, you may need to delete any persistently running
version of procedure adeuib/_semain.w.
</P>

<P><A NAME="5.1.1"><B>5.1.1 Procedure
to Delete a Persistent Version of _semain.w
</B></A></P>

<P>
To
delete the persistently running version of _semain.w, follow this procedure:
</P>

<P>
Note: You can see the persistent procedure
adeshar/_mlmgr.p running during an AppBuilder session using the Procedure
Object Viewer ProTool (you must turn off the Procedure Viewer's &quot;Hide ADE
Procedures&quot; option to see the procedure).
</P>

<P>
1.
Access the Procedure Object Viewer ProTool.
</P>

<P>
2.
Turn off the &quot;Hide ADE Procedures&quot; option.
</P>

<P>
3.
Select the adeuib/_semain.w entry you want to delete and
choose the Delete button.
</P>

<P>
Once
you delete the existing _semain.w persistent procedure, you can choose options
in the AppBuilder that display the Section Editor. This should compile and
persistently run the local copy of _semain.w so you can test your changes.
</P>

<P><A NAME="5.2"><B>5.2
Multiple Section Editor Windows
</B></A></P>

<P>
This
section highlights several important development issues regarding multiple
Section Editor Window support.
</P>

<P><A NAME="5.2.1"><B>5.2.1 Section
Editor Preferences
</B></A></P>

<P>
A
new _multiple_section_ed shared variable in adeuib/sharvars.i holds the logical
&quot;Display multiple Section Editors&quot; value. The files adeuib/_getpref.p and _putpref.p were updated to read
and write the value to the Windows Registry.
</P>



<P>
5.2.1.1.
Many to One Section Editors
</P>

<P>
In
the case where the end user has many Section Editors open and then deselects
the &quot;Display multiple Section Editors&quot; preference, except for the
design window that has focus, each design window's _P._hSecEd variable is re-pointed
to the single Section Editor instance.
</P>



<P>
5.2.1.1
One to Many Section Editors
</P>

<P>
In
the case where several design windows are open, all parented to a single
Section Editor, each design window's _P._hSecEd variable points to that Section
Editor. If the user then selects the
&quot;Display multiple Section Editors&quot; preference, changing it to TRUE,
the design window with focus continues to use the single Section Editor.
</P>

<P>
All
other design window connections to the single Section Editor are broken; that
is, their _P._hSecEd variable is cleared. Design Window Focus), a new Section
Editor instance is created for these windows; see he information in section
5.2.8 Design Window Focus.
</P>

<P><A NAME="5.2.2"><B>5.2.2 Shared
Variable hSecEd
</B></A></P>

<P>
The
key shared variable used by the AppBuilder to access the Section Editor is
hSecEd and the key procedure where access to the Section Editor is achieved is
call_sew in adeuib/uibmproa.i. To support multiple Section Editors, variable
hSecEd points to the correct Section Editor window for whatever design window is
requesting Section Editor access (e.g., &quot;edit code&quot;) or when commands
are sent to the Section Editor (e.g., &quot;store code&quot; or
&quot;hide&quot;). AppBuilder sets the hSecEd value to the appropriate Section
Editor procedure handle using the procedure object's _P._hSecEd field. If the
value is not a valid Section Editor procedure handle, then the AppBuilder
starts a Section Editor window and assigns the newly created procedure handle
to the _P._hSecEd field and to the hSecEd shared variable.
</P>

<P><A NAME="5.2.3"><B>5.2.3 Section
Editor Procedure Handle
</B></A></P>

<P>
Each
design window stores its associated Section Editor procedure handle in the
_P._hSecEd field.
</P>

<P><A NAME="5.2.4"><B>5.2.4 Call_sew_getHandle
Procedure
</B></A></P>

<P>
Procedure
call_sew_getHandle (defined in uibmproa.i) sets and returns the handle to a
design window's Section Editor procedure. Starts new Section Editor windows, as
needed, and sets the procedure object's Section Editor handle field _P._hSecEd
and the shared hSecEd variable to the appropriate values.
</P>

<P><A NAME="5.2.5"><B>5.2.5 Call_sew_setHandle
Procedure
</B></A></P>

<P>
When
focus enters a Section Editor window, it's important to have the AppBuilder
update its internal variable hSecEd to the procedure handle of the entered
window. Since hSecEd is not directly
available in the Section Editor code, a procedure is needed in uibmproa.i to
set the Section Editor handle variable hSecEd. This is accomplished with
procedure call_se_setHandle and is defined in uibmproa.i.
</P>

<P><A NAME="5.2.6"><B>5.2.6 check_UIB_current_window
Procedure
</B></A></P>

<P>
Procedure
check_UIB_current_window in _seprocs.i is also called when the Section Editor
window is entered and when someone calls the Section Editor code to store
trigger code. It is called to ensure the current design window in the
AppBuilder matches the Section Editor being entered.
</P>

<P><A NAME="5.2.7"><B>5.2.7 Section
Editor ENTRY Trigger
</B></A></P>

<P>
The
calls to AppBuilder procedures check_UIB_current_window and call_sew_setHandle
come from an ENTRY trigger in the SE _semain.w code. Since _semain.w is an
AppBuilder-maintained window file, the trigger is added to _semain.w using the
AppBuilder. Here are the key processing points in the ENTRY trigger.
</P>



<P>
ON ENTRY OF h_sewin /* Section Editor */
</P>

<P>
DO:
</P>

<P>
 DEFINE VARIABLE
WinHandle AS WIDGET-HANDLE
NO-UNDO.
</P>

<P>
 /*Set current design
window to the one for this section editor.*/
</P>

<P>
 RUN
check_UIB_current_window.
</P>

<P>
 .
</P>

<P>
 .
</P>

<P>
 /*Set global setting
for current section editor to this one. */
</P>

<P>
 RUN call_sew_setHandle
IN _h_uib (THIS-PROCEDURE:HANDLE).
</P>



<P>
 /* Set se_event and
se_section to their current values for this SE instance. */
</P>

<P>
 .
</P>

<P>
 .
</P>

<P>
END.
</P>



<P><A NAME="5.2.8"><B>5.2.8 Design
Window Focus
</B></A></P>

<P>
When
changing focus from one design window to another, the shared hSecEd variable is
updated to the design window's _P._hSecEd value that has focus.
</P>

<P><A NAME="5.2.9"><B>5.2.9 Section
Editor Window Placement
</B></A></P>

<P>
The
code that handles where the Section Editor initially displays on the screen is
in the SecEdWindow procedure in _seprocs.i.
The result of running this code is that the Section Editor window's
initial location is just below the AppBuilder main window, flush right to the
screen edge.
</P>



<P>
IF SE_Created = FALSE THEN DO:
</P>

<P>
 ASSIGN h_sewin:ROW = (_h_menu_win:HEIGHT+3) NO-ERROR.
</P>

<P>
 ASSIGN h_sewin:COLUMN =
(SESSION:WIDTH-h_sewin:WIDTH)-1 NO-ERROR.
</P>

<P>
 ENABLE isection
btn_list btn_pcall se_event btn_new btn_rename
 wname txt WITH FRAME f_edit.
</P>

<P>
END.
</P>



<P>
The
problem that arises with multiple Section Editors, each using the same code
above, is that they overlap each other and there is no affordance to indicate
this condition. Some other rule is
needed for multiple Section Editor window placement.
</P>




<P><A NAME="5.2.10"><B>5.2.10 File Close and
Close Windows
</B></A></P>

<P>
The
File Close and Close Windows menu items re-point the hSecEd variable to the
current design window's Section Editor window procedure handle, which is
retrieved from the _P._hSecEd temp-table field.
</P>

<P>
If
the Multiple Section Editor feature is off when the Section Editor window is
closed, the Section Editor window is hidden and its persistent procedure
remains running. This improves performance when the Section Editor is requested
to open again because a persistent procedure doesn't have to be started again
(the persistent procedure that is currently running is used). If the Multiple
Section Editor feature is on when a Section Editor is closed, the Section
Editor window and its persistent procedure are deleted from memory. This
prevents extra Section Editor persistent procedures from being orphaned (that
is, unusable).
</P>

<P><A NAME="6"><B>6
Dependencies
</B></A></P>

<P>
Not Applicable
</P>

<P><A NAME="7"><B>7 Source
Files
</B></A></P>

<P>
Code for this
product is principally located in the ADE adeuib directory. Additionally, code
is used from the adecomm and adeshar directories. See the ADE Common and Shared
Routines Open Source document for detailed information about these directories.
</P>

<P><A NAME="8"><B>8 Build Process and Requirements
</B></A></P>

<P>
Not Applicable
</P>

<P><A NAME="9"><B>9
Execution Methods
</B></A></P>

<P>
Not
Applicable
</P>

<P><A NAME="10"><B>10
Test Requirements and Strategies
</B></A></P>

<P>
Not Applicable
</P>

<P><A NAME="11"><B>11
Supplementary Information
</B></A></P>

<P>
Not Applicable
</P>




<P><A NAME="12"><B>12
Related Documentation</B></A></P>

<P>
This section identifies additional information available
in the standard Progress documentation set and the Open Source web environment.
These documents provide additional information about the Section Editor and how
to modify it:
</P>

<P>
·
Section Editor
Online Help
</P>

<P>
·
AppBuilder
Developer's Guide
</P>

<P>
·
AppBuilder
OpenSource online documents
</P>







</SPAN>