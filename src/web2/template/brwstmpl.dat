<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<!--------------------------------------------------------------------
* Copyright (C) 2000 by Progress Software Corporation ("PSC"),       *
* 14 Oak Park, Bedford, MA 01730, and other contributors as listed   *
* below.  All Rights Reserved.                                       *
*                                                                    *
* The Initial Developer of the Original Code is PSC.  The Original   *
* Code is Progress IDE code released to open source December 1, 2000.*
*                                                                    *
* The contents of this file are subject to the Possenet Public       *
* License Version 1.0 (the "License"); you may not use this file     *
* except in compliance with the License.  A copy of the License is   *
* available as of the date of this notice at                         *
* http://www.possenet.org/license.html                               *
*                                                                    *
* Software distributed under the License is distributed on an "AS IS"*
* basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. You*
* should refer to the License for the specific language governing    *
* rights and limitations under the License.                          *
*                                                                    *
* Contributors:                                                      *
*                                                                    *
--------------------------------------------------------------------->
<html>
<head>
<meta name="wsoptions" content="no-output">
<title>##GetField('PageTitle')##</title>
##HTMLTagLink('link rel=stylesheet','StyleSheet','type="text/css"')##
</head>

<body ##HTMLAttribute('bgcolor','pagebgcolor')## ##HTMLAttribute('background','PageBackground')##>
<center>

<!-- Report Title -->
<p><strong>##GetField('PageTitle')##</strong><br><br></p>

<script language="SpeedScript">
DEFINE VARIABLE searchValue    AS CHAR NO-UNDO.
DEFINE VARIABLE CurrentRowids  AS CHAR NO-UNDO.
DEFINE VARIABLE TmpUrl         AS CHAR NO-UNDO.
DEFINE VARIABLE DelimiterField AS CHAR NO-UNDO. 
  
DEFINE VARIABLE UseNavigation  AS LOG  INIT  ##getField('UseNavigationPanel')## NO-UNDO.
DEFINE VARIABLE UseSearchForm  AS LOG  INIT  ##getField('UseSearchForm')## NO-UNDO.
DEFINE VARIABLE DataObject     AS CHAR INIT  '##getField('DataObject')##' NO-UNDO.
DEFINE VARIABLE DataSourceHdl  AS HANDLE NO-UNDO.

/* Forward declare the Status line function */ 
FUNCTION LinkStatusLine RETURNS CHARACTER FORWARD.
  
/** Defines properties and starts the super procedure web2/wbtable.p */ 
{src/web2/wbtable.i}

setExternalTableList('##getField('ExternalTables')##').  
setForeignFieldList('##getField('ForeignFields')##'). 
   
IF DataObject <> '' THEN 
DO:
  setAppService('##getField('AppService')##').
  startDataObject(DataObject).  
  ##instanceProperties('DataSourceHdl')##  
END.
ELSE DO:
  /** WebRep.p uses dynamic queries and buffers .
      You can use user variables instead of hardcoded values. */         
  setBuffers('##getField('Tables')##').  
  setQueryWhere('##getField('4GLQuery')##').
  setExternalJoinList('##getField('ExternalJoin'##').  
  setExternalWhereList('##getField('ExternalWhere')##').
END.

/** You can use user variables instead of hardcoded values also for columns */       
setColumns('##getField('Columnlist')##'). 
  
##OverrideColumns('Label')##
##OverrideColumns('Format')##

/** Set the number of Rows */  
setTableRows(##getField('TableRows')##).  
  
/** Set attributes for the <table> tag */  
setTableModifier('##HTMLAttribute('bgcolor','TableBGColor')## ##HTMLAttribute('background','TableBackground')## ##HTMLAttribute('border','TableBorder')##').  
  
/** Use labels in the table */
setUseColumnLabels(##getField('UseColumnHeadings')##).  
  
/** Add a link for a column */ 
addColumnLink('##getField('LinkColumn')##', /* Column name */
              '##getField('WebObject')##', /* WebObject   */
              '##getField('TargetFrame')##', /* TargetFrame */
              'LinkStatusLine', /* Function name for Status Line */
              '##getField('JoinColumns')##'). /* JoinColumns (ROWID or list of fields) */
                         
                           
IF UseSearchForm THEN 
DO: 
  /* Set the field to use for search. 
   * Supports one column only. 
   * The field used in the searchForm has (name=SearchValue)
   * The corresponding data from searchValue will be used in the selection 
   * criteria. 
   * The operator will be GE  */  
  setSearchColumns('##getField('SearchColumns')##'). 

</script>
<form method="POST" name="SearchForm">
    <input type="hidden" name="Navigate" value="Search">
    <p><strong>`columnLabel(ENTRY(1,getSearchColumns()))`
    <input type="text" size="20" name="SearchValue" value="`html-encode(get-field('searchValue'))`">
    <input type="submit" name="SubmitBtn" value="Search">
    </strong></p>
    <hr>
</form>
<script language="SpeedScript">
END. /* IF UseSearchForm THEN DO: */

/** ProcessWebReqest gets the value for Navigate and SearchValue,  */
/** opens the query and outputs the table. */          
RUN ProcessWebRequest.

ASSIGN 
  TmpUrl         = url-format(?,getContextFields(),?)    
  Delimiterfield = IF INDEX(TmpUrl,"?") > 0
                   THEN ?
                   ELSE "?"   
  TmpUrl         = TmpUrl + url-field("CurrentRowids":U,getCurrentRowids(),DelimiterField)
  DelimiterField = IF INDEX(TmpUrl,"?") > 0
                   THEN ?
                   ELSE "?".         


/* If we are using a SearchForm we set its CurrentRowid to the current rowid */  
IF UseSearchForm THEN 
DO: 

</script>

<script language="JavaScript">
   {document.SearchForm.href = "`TmpUrl`";}
</script>

<script language="SpeedScript">
END. /* IF UseSearchForm THEN DO: */
</script>

</center>

<script language="SpeedScript">

IF UseNavigation THEN DO: 
</script>

 <div align="center"><center>

 <table border="2">
    <tr>
        <td><a
        href="`TmpUrl%20+%20url-field('Navigate','First',DelimiterField)`"
        onmouseover="window.status='First `getTableRows()`';return true"
        onmouseout="window.status='';return true"><img
        src="`RootURL`/images/first-au.gif" border="0" width="16"
        height="16"></a></td>
        <td><a
        href="`TmpUrl%20+%20url-field('Navigate','Prev',DelimiterField)`"
        onmouseover="window.status='Previous `getTableRows()`';return true"
        onmouseout="window.status='';return true"><img
        src="`RootURL`/images/prev-au.gif" border="0" width="16"
        height="16"></a></td>
        <td><a
        href="`TmpUrl%20+%20url-field('Navigate','Next',DelimiterField)`"
        onmouseover="window.status='Next `getTableRows()`';return true"
        onmouseout="window.status='';return true"><img
        src="`RootURL`/images/next-au.gif" border="0" width="16"
        height="16"></a></td>
        <td><a
        href="`TmpUrl%20+%20url-field('Navigate','Last',DelimiterField)`"
        onmouseover="window.status='Last `getTableRows()`';return true"
        onmouseout="window.status='';return true"><img
        src="`RootURL`/images/last-au.gif" border="0" width="16"
        height="16"></a></td>
    </tr>
 </table>
 </center></div>
<script language="SpeedScript">
END.  /* IF UseNavigation THEN DO: */

IF anyMessage() THEN
 showDataMessages().

FUNCTION LinkStatusLine RETURNS CHARACTER ():
  RETURN  ##EmbeddedExpression('StatusLine')##.
END. 

</script>

</body>
</html>








