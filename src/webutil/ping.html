<!--------------------------------------------------------------------
* Copyright (C) 2000 by Progress Software Corporation ("PSC"),       *
* 14 Oak Park, Bedford, MA 01730, and other contributors as listed   *
* below.  All Rights Reserved.                                       *
*                                                                    *
* The Initial Developer of the Original Code is PSC.  The Original   *
* Code is Progress IDE code released to open source December 1, 2000.*
*                                                                    *
* The contents of this file are subject to the Possenet Public       *
* License Version 1.0 (the "License"); you may not use this file     *
* except in compliance with the License.  A copy of the License is   *
* available as of the date of this notice at                         *
* http://www.possenet.org/license.html                               *
*                                                                    *
* Software distributed under the License is distributed on an "AS IS"*
* basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. You*
* should refer to the License for the specific language governing    *
* rights and limitations under the License.                          *
*                                                                    *
* Contributors:                                                      *
*                                                                    *
--------------------------------------------------------------------->
<SCRIPT LANGUAGE="WebSpeed4GL">
  /*------------------------------------------------------------------------
    File: webutil/ping.html

    Description: Tests for the existance of relevant Workshop WebTools files.  
                 A person that has installed Workshop can issue the URL:
                     http://<host>/<ws.cgi>/webutil/ping
                 This file will do a simple check for both WebSpeed r-code
                 files and static files.
   
    Parameters:  <none>

    Author:  Wm. T. Wood
    Created: 5/5/97
    Updated: 8/26/98 adams for Skywalker 9.0A
  ------------------------------------------------------------------------*/
  /*          This .HTML file was created with WebSpeed Workshop.         */
  /*----------------------------------------------------------------------*/
 
  /* Output the standard HTML header. */
  {&OUT}
     { webtools/html.i &SEGMENTS = "head"
                       &AUTHOR   = "D.M.Adams"
                       &TITLE    = "Ping" } .

  /* Define functions for testing a file. This function outputs
     a "." for every file found. That way, if a user reports an
     error, all we have to do is ask how many does were seen. */
  FUNCTION checkFile returns logical (INPUT filName AS CHARACTER):
    FILE-INFO:FILE-NAME = filName.
    IF FILE-INFO:FULL-PATHNAME eq ? THEN RETURN false.
    ELSE DO:
      {&OUT} '.'.  
      RETURN TRUE.
    END.
  END FUNCTION.

  /* Procedure to check for directory existance. */
  PROCEDURE checkDir :
    DEFINE INPUT PARAMETER dirName AS CHAR NO-UNDO.
    DEFINE INPUT PARAMETER filList AS CHAR NO-UNDO.

    DEFINE VARIABLE cnt  AS INTEGER NO-UNDO.
    DEFINE VARIABLE i    AS INTEGER NO-UNDO.
    DEFINE VARIABLE l_ok AS LOGICAL NO-UNDO.

    FILE-INFO:FILE-NAME = dirName.
    IF FILE-INFO:FULL-PATHNAME eq ? OR (NOT FILE-INFO:FILE-TYPE BEGINS "D":U)
    THEN {&OUT} '<LI>Directory <I>' dirName 
                '</I> does <FONT COLOR="RED" SIZE="+1"><B><BLINK>not</BLINK></B></FONT> exist.</LI>~n'.  
    ELSE DO:
      {&OUT} '<LI>Testing..'.
      ASSIGN i    = 0
             cnt  = NUM-ENTRIES (filList)
             l_OK = yes.
      DO WHILE l_OK AND i < cnt:
        i = i + 1.
        l_OK = checkFile (dirName + "/":U + ENTRY(i, filList)).
      END.
      IF l_OK 
      THEN {&OUT} ' OK</LI>'.
      ELSE {&OUT} ' <FONT COLOR="RED" SIZE="+2"><B><BLINK>failed</BLINK></B></FONT></LI>'.
    END. 
  END PROCEDURE.
</SCRIPT>

<BODY BACKGROUND="`RootURL`/images/bgr/wsbgr.gif" TEXT="BLACK">
<H1><B><FONT COLOR="#FF0000">Web</FONT>Speed</B> Workshop WebTools
<B><I>&quot;Ping&quot;</I></B></H1>
<HR WIDTH="100%">

<H2>Test 1 - Checking Web Objects</H2>

<P>This web object tests your installation of <B><FONT COLOR="#FF0000">Web</FONT>Speed</B>
Workshop WebTools <I>(Version `PROVERSION`)</I>. First, a test
will be done to make sure the web objects needed to run Workshop WebTools
are accessible from this WebSpeed Transaction&nbsp;Agent <I>(`ENTRY(2,WEB-CONTEXT:EXCLUSIVE-ID,&quot;=&quot;:U)`).</I></P>

<UL>
<H3>Checking Standard Utilities</H3>

<UL>
<SCRIPT LANGUAGE="WebSpeed4GL">
  /* Check for the DLC/tty/webutil directory. */
  RUN checkDir ('webutil':U, '_genoff.r,_wstyle.r,_promsgs.r,_relname.r,e4gl-gen.r':U).
</SCRIPT>
</UL>

<H3>Checking WebTools Files</H3>

<UL>
<SCRIPT LANGUAGE="WebSpeed4GL">
  /* Check for the DLC/tty/webtools directory. */
  RUN checkDir ('webtools':U, 'edtscrpt.r,dirlist.r,index.r,dblist.r,util/_fileact.r':U).
</SCRIPT>
</UL>

<HR WIDTH="100%">
<H2>Test 2 - Checking Image and Documentation Files</H2>

<P>In addition to the Workshop WebTools web objects associated with your 
Transaction&nbsp;Agent, your web server <i>(`SERVER_NAME`)</i>
must have the static Workshop WebTools images and on-line documentation available
in the webspeed directory off the web server's document root.</P>

<P>The list below should show image files if <B><FONT COLOR="#FF0000">Web</FONT>Speed
</B>has been configured properly on your web server. If the images show
as broken links, then there is some problem with your installation.</P>

<CENTER>
<TABLE BORDER=1 WIDTH="80%" >
  <TR>
    <TH>Testing Image File</TH>
    <TH ALIGN="CENTER">Image<BR><FONT COLOR="RED">(Broken image links below indicate setup problem.)</FONT></TH>
    <TH ALIGN="CENTER">Associated Directory<BR><FONT COLOR="RED">(Don't worry if your web server disallows direct access below.)</FONT></TH>
  </TR>

  <TR>
    <TD>WebSpeed logo for Workshop</TD>
    <TD ALIGN="CENTER"><IMG SRC="`RootURL`/workshop/webspeed.gif" HEIGHT=27 WIDTH=112 ALT="WebSpeed Logo"></TD>
    <TD ALIGN="CENTER"><A HREF="`RootURL`/workshop">/webspeed/workshop</A></TD>
  </TR>

  <TR>
    <TD>WebTools logo</TD>
    <TD ALIGN="CENTER"><IMG SRC="`RootURL`/images/l-tools.gif" WIDTH=55 HEIGHT=45 ALT="WebTools Logo"></TD>
    <TD ALIGN="CENTER"><A HREF="`RootURL`/images">/webspeed/images</A></TD>
  </TR>

  <TR>
    <TD>WebSpeed Library logo</TD>
    <TD ALIGN="CENTER"><img src="`RootURL`/doc/wshelp/images/books2.gif" width="119" height="89" ALT="Library Logo"></TD>
    <TD ALIGN="CENTER"><A HREF="`RootURL`/doc">/webspeed/doc</A></TD>
  </TR>
</TABLE>
</CENTER>

<HR WIDTH="100%">
<BR><BR>
<CENTER>
<FONT SIZE="+1">
Click <A HREF="`AppURL`/workshop" TARGET="_top">here</A> to start
<B><FONT COLOR="#FF0000">Web</FONT>Speed</B> Workshop WebTools.
</FONT>
<BR>
&nbsp;
</CENTER>
</BODY>
</HTML>
