<SCRIPT LANGUAGE="WebSpeed4GL">
  /*------------------------------------------------------------------------
    File: workshop/ping.html

    Description: Tests for the existance of relevant workshop files.  A
                 person that has installed Workshop can issue the URL:
                        http://<host>/<ws.cgi>/workshop/ping
                 This file will do a simple check for both workshop r-code
                 files and static files.
   
    Parameters:  <none>

    Author:  Wm. T. Wood
    Created: April 5, 1997
  ------------------------------------------------------------------------*/
  /*          This .HTML file was created with WebSpeed Workshop.         */
  /*----------------------------------------------------------------------*/

 
  /* Output the standard HTML header. */
  {&OUT}
     { workshop/html.i &SEGMENTS = "head"
                       &AUTHOR   = "Wm.T.Wood"
                       &TITLE    = "Ping" } .

  /* Define functions for testing a file. This function outputs
     a "." for every file found. That way, if a user reports an
     error, all we have to do is ask how many does were seen. */
  FUNCTION checkFile returns logical (input filName as char):
    FILE-INFO:FILE-NAME = filName.
    IF FILE-INFO:FULL-PATHNAME eq ? THEN RETURN false.
    ELSE DO:
      {&OUT} '.'.  
      RETURN true.
    END.
  END FUNCTION.

  /* Procedure to check for directory existance. */
  PROCEDURE checkDir :
    DEFINE INPUT PARAMETER dirName AS CHAR NO-UNDO.
    DEFINE INPUT PARAMETER filList AS CHAR NO-UNDO.

    DEFINE VARIABLE cnt  AS INTEGER NO-UNDO.
    DEFINE VARIABLE i    AS INTEGER NO-UNDO.
    DEFINE VARIABLE l_ok AS LOGICAL NO-UNDO.

    FILE-INFO:FILE-NAME = dirName.
    IF FILE-INFO:FULL-PATHNAME eq ? OR (NOT FILE-INFO:FILE-TYPE BEGINS "D":U)
    THEN {&OUT} '<li>Directory <i>' dirName 
                '</i> does <font color="RED" size="+1"><b><blink>not</blink></b></font> exist.</li>~n'.  
    ELSE DO:
      {&OUT} '<li>Testing..'.
      ASSIGN i    = 0
             cnt  = NUM-ENTRIES (filList)
             l_OK = yes.
      DO WHILE l_OK AND i < cnt:
        i = i + 1.
        l_OK = checkFile (dirName + "/":U + ENTRY(i, filList)).
      END.
      IF l_OK 
      THEN {&OUT} ' OK</li>'.
      ELSE {&OUT} ' <font color="RED" size="+2"><b><blink>failed</blink></b></font></li>'.
    END. 
  END PROCEDURE.

</SCRIPT>
<BODY BACKGROUND = "/webspeed/images/bgr/wsbgr.gif" TEXT="BLACK">
<H1><B><FONT COLOR="#FF0000">Web</FONT>Speed</B> Workshop
<B><I>&quot;Ping&quot;</I></B></H1>
<HR WIDTH="100%">

<H2>Test 1 - Checking Web Objects</H2>

<P>This web object tests your installation of <B><FONT COLOR="#FF0000">Web</FONT>Speed</B>
Workshop <i>(Version `PROVERSION`)</i>. First, a test
will be done to make sure the web objects needed to run Workshop
are accessible from this WebSpeed Transaction&nbsp;Agent <I>(`ENTRY(2,WEB-CONTEXT:EXCLUSIVE-ID,&quot;=&quot;:U)`).</I></P>

<UL>
<H3>Checking Standard Utilities</H3>

<UL>
<SCRIPT LANGUAGE="WebSpeed4GL">
  /* Check for the DLC/tty/webutil directory. */
  RUN checkDir ('webutil':U, '_genoff.r,_wstyle.r,_promsgs.r,_relname.r,e4gl-gen.r':U).
</SCRIPT>
</UL>

<H3>Checking WebTools Files</H3>

<UL>
<SCRIPT LANGUAGE="WebSpeed4GL">
  /* Check for the DLC/tty/webtools directory. */
  RUN checkDir ('webtools':U, 'edtscrpt.r,dirlist.r,index.r,dblist.r,util/_fileact.r':U).
</SCRIPT>
</UL>

<H3>Checking Other Workshop Files</H3>

<UL>
<SCRIPT LANGUAGE="WebSpeed4GL">
  /* Check for the DLC/tty/workshop directory. */
  RUN checkDir ('workshop':U, '_main.r,_secomm.r,_project.r,_file.r,_list.r':U).
</SCRIPT>
</UL>
</UL>


<HR WIDTH="100%">


<H2>Test 2 - Checking Image and Documentation Files</H2>

<P>In addition to the Workshop web
objects associated with your Transaction&nbsp;Agent, your web server <i>(`SERVER_NAME`)</i>
must have the static Workshop images and on-line documentation available
in the webspeed directory off the web server's document root.</P>

<P>The list below should show image files if <B><FONT COLOR="#FF0000">Web</FONT>Speed
</B>has been configured properly on your web server. If the images show
as broken links, then there is some problem with your installation.</P>

<CENTER><TABLE BORDER=1 WIDTH="80%" >
<TR>
  <TH>Testing Image File</TH>
  <TH ALIGN="CENTER">Image<br><font color="RED">(Broken image links below indicate setup problem.)</font></TH>
  <TH ALIGN="CENTER">Associated Directory<br><font color="RED">(Don't worry if your web server disallows direct access below.)</font></TH>
</TR>

<TR>
  <TD>WebSpeed logo for Workshop</TD>
  <TD ALIGN="CENTER"><IMG SRC="/webspeed/workshop/webspeed.gif" HEIGHT=27 WIDTH=112 ALT="WebSpeed Logo"></TD>
  <TD ALIGN="CENTER"><A HREF="/webspeed/workshop">/webspeed/workshop</A></TD>
</TR>

<TR>
  <TD>WebTools logo</TD>
  <TD ALIGN="CENTER"><IMG SRC="/webspeed/images/l-tools.gif" WIDTH=55 HEIGHT=45 ALT="WebTools Logo"></TD>
  <TD ALIGN="CENTER"><A HREF="/webspeed/images">/webspeed/images</A></TD>
</TR>

<TR>
  <TD>WebSpeed Library logo</TD>
  <TD ALIGN="CENTER"><img src="/webspeed/doc/wshelp/images/books2.gif" width="119" height="89" ALT="Library Logo"></TD>
  <TD ALIGN="CENTER"><A HREF="/webspeed/doc">/webspeed/doc</A></TD>
</TR>

</TABLE></CENTER>


<HR WIDTH="100%">
<BR><BR>
<CENTER>
<FONT SIZE="+1">
Click <A HREF="`AppURL`/workshop" TARGET="_top">here</A> to start
<B><FONT COLOR="#FF0000">Web</FONT>Speed</B> Workshop.
</FONT>
<BR>
&nbsp;
</CENTER>
</BODY>
</HTML>
